/*!
 * Tiny FormatPainter plugin
 *
 * Copyright (c) 2023 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 7.8.0-392
 */

!function(){"use strict";const e=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},t=e=>parseInt(e,10),r=(e,t)=>{const r=e-t;return 0===r?0:r>0?1:-1},o=(e,t,r)=>({major:e,minor:t,patch:r}),n=e=>{const r=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return r?o(t(r[1]),t(r[2]),t(r[3])):o(0,0,0)},s=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(r=o=e,(n=String).prototype.isPrototypeOf(r)||(null===(s=o.constructor)||void 0===s?void 0:s.name)===n.name)?"string":t;var r,o,n,s})(t)===e,i=e=>t=>typeof t===e,a=s("string"),c=s("array"),l=i("boolean"),m=e=>undefined===e;const u=e=>!(e=>null==e)(e),d=i("function"),g=i("number"),h=e=>()=>e,f=e=>e,p=h(!1),v=h(!0);class b{constructor(e,t){this.tag=e,this.value=t}static some(e){return new b(!0,e)}static none(){return b.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?b.some(e(this.value)):b.none()}bind(e){return this.tag?e(this.value):b.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:b.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return u(e)?b.some(e):b.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}b.singletonNone=new b(!1);const y=Array.prototype.indexOf,S=Array.prototype.push,w=(e,t)=>((e,t)=>y.call(e,t))(e,t)>-1,x=(e,t)=>{for(let r=0,o=e.length;r<o;r++)if(t(e[r],r))return!0;return!1},k=(e,t)=>{const r=e.length,o=new Array(r);for(let n=0;n<r;n++){const r=e[n];o[n]=t(r,n)}return o},A=(e,t)=>{const r=[];for(let o=0,n=e.length;o<n;o++){const n=e[o];t(n,o)&&r.push(n)}return r},O=(e,t)=>((e,t,r)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];if(t(n,o))return b.some(n);if(r(n,o))break}return b.none()})(e,t,p),C=(e,t)=>(e=>{const t=[];for(let r=0,o=e.length;r<o;++r){if(!c(e[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+e);S.apply(t,e[r])}return t})(k(e,t)),L=()=>T(0,0),T=(e,t)=>({major:e,minor:t}),R={nu:T,detect:(e,t)=>{const r=String(t).toLowerCase();return 0===e.length?L():((e,t)=>{const r=((e,t)=>{for(let r=0;r<e.length;r++){const o=e[r];if(o.test(t))return o}})(e,t);if(!r)return{major:0,minor:0};const o=e=>Number(t.replace(r,"$"+e));return T(o(1),o(2))})(e,r)},unknown:L},_=(e,t)=>{const r=String(t).toLowerCase();return O(e,(e=>e.search(r)))},P=(e,t,r=0,o)=>{const n=e.indexOf(t,r);return-1!==n&&(!!m(o)||n+t.length<=o)},F=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,B=e=>t=>P(t,e),E=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>P(e,"edge/")&&P(e,"chrome")&&P(e,"safari")&&P(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,F],search:e=>P(e,"chrome")&&!P(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>P(e,"msie")||P(e,"trident")},{name:"Opera",versionRegexes:[F,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:B("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:B("firefox")},{name:"Safari",versionRegexes:[F,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(P(e,"safari")||P(e,"mobile/"))&&P(e,"applewebkit")}],D=[{name:"Windows",search:B("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>P(e,"iphone")||P(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:B("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:B("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:B("linux"),versionRegexes:[]},{name:"Solaris",search:B("sunos"),versionRegexes:[]},{name:"FreeBSD",search:B("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:B("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],N={browsers:h(E),oses:h(D)},j=e=>{const t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isEdge:o("Edge"),isChromium:o("Chromium"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o("Firefox"),isSafari:o("Safari")}},I=()=>j({current:void 0,version:R.unknown()}),M=j,V=e=>{const t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isWindows:o("Windows"),isiOS:o("iOS"),isAndroid:o("Android"),isMacOS:o("macOS"),isLinux:o("Linux"),isSolaris:o("Solaris"),isFreeBSD:o("FreeBSD"),isChromeOS:o("ChromeOS")}},U=()=>V({current:void 0,version:R.unknown()}),W=V,$=(e,t,r)=>{const o=N.browsers(),n=N.oses(),s=t.bind((e=>((e,t)=>((e,t)=>{for(let r=0;r<e.length;r++){const o=t(e[r]);if(o.isSome())return o}return b.none()})(t.brands,(t=>{const r=t.brand.toLowerCase();return O(e,(e=>{var t;return r===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:R.nu(parseInt(t.version,10),0)})))})))(o,e))).orThunk((()=>((e,t)=>_(e,t).map((e=>{const r=R.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(o,e))).fold(I,M),i=((e,t)=>_(e,t).map((e=>{const r=R.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(n,e).fold(U,W),a=((e,t,r,o)=>{const n=e.isiOS()&&!0===/ipad/i.test(r),s=e.isiOS()&&!n,i=e.isiOS()||e.isAndroid(),a=i||o("(pointer:coarse)"),c=n||!s&&i&&o("(min-device-width:768px)"),l=s||i&&!c,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),u=!l&&!c&&!m;return{isiPad:h(n),isiPhone:h(s),isTablet:h(c),isPhone:h(l),isTouch:h(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:h(m),isDesktop:h(u)}})(i,s,e,r);return{browser:s,os:i,deviceType:a}},q=e=>window.matchMedia(e).matches;let z=(e=>{let t,r=!1;return(...o)=>(r||(r=!0,t=e.apply(null,o)),t)})((()=>$(window.navigator.userAgent,b.from(window.navigator.userAgentData),q)));const K=()=>z(),Z=Object.keys,G=Object.hasOwnProperty,H=(e,t)=>{const r=Z(e);for(let o=0,n=r.length;o<n;o++){const n=r[o];t(e[n],n)}},J=(e,t)=>{const r={};return H(e,((e,o)=>{const n=t(e,o);r[n.k]=n.v})),r},Q=e=>(t,r)=>{e[r]=t},X=e=>((e,t)=>{const r=[];return H(e,((e,o)=>{r.push(t(e,o))})),r})(e,f),Y=(e,t)=>ee(e,t)?b.from(e[t]):b.none(),ee=(e,t)=>G.call(e,t);"undefined"!=typeof window?window:Function("return this;")();const te=e=>t=>(e=>e.dom.nodeType)(t)===e,re=te(1),oe=te(3),ne=te(11),se=(e,t,r)=>{((e,t,r)=>{if(!(a(r)||l(r)||g(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,r+"")})(e.dom,t,r)},ie=(e,t)=>{const r=e.dom.getAttribute(t);return null===r?void 0:r},ae=(e,t)=>{e.dom.removeAttribute(t)},ce=(e,t)=>{const r=ie(e,t);return void 0===r||""===r?[]:r.split(" ")},le=e=>void 0!==e.dom.classList,me=e=>ce(e,"class"),ue=(e,t)=>{le(e)?e.dom.classList.remove(t):((e,t)=>{((e,t,r)=>{const o=A(ce(e,t),(e=>e!==r));o.length>0?se(e,t,o.join(" ")):ae(e,t)})(e,"class",t)})(e,t),(e=>{0===(le(e)?e.dom.classList:me(e)).length&&ae(e,"class")})(e)},de=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},ge=de,he=(e,t)=>{e.dispatch("FormatPainterToggle",{state:t})};var fe,pe,ve,be;!function(e){e.Retrival="Retrieval",e.Application="Application"}(fe||(fe={})),function(e){e.ListSchema="ListSchema",e.SubstitutionSchema="SubstitionSchema"}(pe||(pe={})),function(e){e.InsertUnorderedList="InsertUnorderedList",e.InsertOrderedList="InsertOrderedList",e.InsertDefinitionList="InsertDefinitionList"}(ve||(ve={})),function(e){e.Table="Table",e.Unspecified="Unspecified"}(be||(be={}));const ye=e=>{var t,r;t=ge(e.getBody()),r="tox-cursor-format-painter",le(t)?t.dom.classList.add(r):((e,t)=>{((e,t,r)=>{const o=ce(e,t).concat([r]);se(e,t,o.join(" "))})(e,"class",t)})(t,r)},Se=(e,t)=>{(e=>{ue(ge(e.getBody()),"tox-cursor-format-painter")})(e),t.set(fe.Retrival),he(e,!1)},we=(e,t)=>e.dom===t.dom,xe=(e,t)=>{const r=e.dom;if(1!==r.nodeType)return!1;{const e=r;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},ke=e=>ge(e.dom.host),Ae=e=>{const t=oe(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const r=t.ownerDocument;return(e=>{const t=(e=>ge(e.dom.getRootNode()))(e);return ne(r=t)&&u(r.dom.host)?b.some(t):b.none();var r})(ge(t)).fold((()=>r.body.contains(t)),(o=Ae,n=ke,e=>o(n(e))));var o,n},Oe=(e,t,r)=>{let o=e.dom;const n=d(r)?r:p;for(;o.parentNode;){o=o.parentNode;const e=ge(o);if(t(e))return b.some(e);if(n(e))break}return b.none()},Ce=(e,t,r)=>((e,t,r,o,n)=>o(r)?b.some(r):d(n)&&n(r)?b.none():t(r,o,n))(0,Oe,e,t,r),Le={formatpainter_checklist:{selector:"ul",classes:"tox-checklist"},formatpainter_liststyletype:{selector:"ul,ol",styles:{listStyleType:"%value"}},formatpainter_borderstyle:{selector:"td,th",styles:{borderTopStyle:"%valueTop",borderRightStyle:"%valueRight",borderBottomStyle:"%valueBottom",borderLeftStyle:"%valueLeft"},remove_similar:!0},formatpainter_bordercolor:{selector:"td,th",styles:{borderTopColor:"%valueTop",borderRightColor:"%valueRight",borderBottomColor:"%valueBottom",borderLeftColor:"%valueLeft"},remove_similar:!0},formatpainter_backgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},formatpainter_removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*:not(tr,td,th,table)",attributes:["style","class"],split:!1,expand:!1,deep:!0}],formatpainter_legacy_font:{inline:"font",attributes:{size:"%value"}}},Te=(e,t)=>Y(t,"selector").exists((t=>{const r=e.getBody(),o=e.selection.getStart(),n=e.dom.getParents(o,v,r),s=e.selection.getSelectedBlocks();return e.dom.is([...n,...s],t)})),Re=e=>e.length>1&&"%"===e.charAt(0),_e=(e,t)=>Y(e,t).filter((e=>!c(e))),Pe=e=>xe(e,"OL,UL,DL"),Fe=e=>xe(e,"LI,DT,DD"),Be=e=>e.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),Ee=(e,t,r)=>{const o=e.formatter,n=((e,t)=>x(e.formatter.get(t),(t=>((e,t)=>ee(t,"inline")&&!Te(e,t))(e,t))))(e,r.formatName),s=((e,t,r)=>x(t.get(r),(t=>((e,t)=>ee(t,"block")||Te(e,t))(e,t))))(e,o,r.formatName),i=(a=r.formatName,w(["formatpainter_borderstyle","formatpainter_bordercolor","formatpainter_backgroundcolor"],a));var a;(t.table&&i||n||t.block&&s&&!i)&&o.apply(r.formatName,r.substitutedVariables)},De=e=>{const t=e.selection,r=t.getRng(),o=ge(e.getBody()),n=(e=>A(e.selection.getSelectedBlocks().map(ge),Fe))(e),s=r.collapsed&&n.length,i=n.length&&!((e,t)=>{const r=e=>we(e,t);return(o=Ce(ge(e.getStart()),Pe,r),n=Ce(ge(e.getEnd()),Pe,r),s=(e,t)=>we(e,t),o.isSome()&&n.isSome()?b.some(s(o.getOrDie(),n.getOrDie())):b.none()).getOr(!1);var o,n,s})(t,o);return n.length>1||s||i},Ne=(e,t)=>{const r=e.dom,o=window.getComputedStyle(r).getPropertyValue(t);return""!==o||Ae(e)?o:je(r,t)},je=(e,t)=>(e=>void 0!==e.style&&d(e.style.getPropertyValue))(e)?e.style.getPropertyValue(t):"",Ie=e=>e.options.get("formatpainter_ignored_formats");const Me=(e,t)=>{return"class"===t?(e=>le(e)?(e=>{const t=e.dom.classList,r=new Array(t.length);for(let e=0;e<t.length;e++){const o=t.item(e);null!==o&&(r[e]=o)}return r})(e):me(e))(e).filter((e=>!/^(mce-.*)/.test(e))).join(" "):(r=e,o=t,b.from(ie(r,o))).getOr("");var r,o},Ve=e=>((e,t)=>{const r={},o={};return((e,t,r,o)=>{H(e,((e,n)=>{(t(e,n)?r:o)(e,n)}))})(e,t,Q(r),Q(o)),{t:r,f:o}})(e,(e=>{return(t=e).length>1&&"%"===t.charAt(0);var t})).t,Ue=(e,t)=>(e=>{const t=Ie(e);return Z(e.formatter.get()).filter((e=>!w(t,e)))})(e).filter((r=>{const o=((e,t)=>x(e.formatter.get(t),(e=>(e=>{const t=_e(e,"styles").exists((e=>x(X(e),Re))),r=_e(e,"attributes").exists((e=>x(X(e),Re)));return t||r})(e))))(e,r);return e.formatter.matchNode(t.dom,r,{},o)})),We=(e,t)=>{const r=k(e.dom.getParents(t,v),ge);return C(A(r,re),(t=>C(Ue(e,t),(r=>((e,t,r)=>{return(o=e.get(t),(e=>0<e.length?b.some(e[0]):b.none())(o)).bind((e=>((e,t)=>{const r=_e(e,"styles").map((e=>{return r=t,o=Ve(e),J(o,((e,t)=>({k:e.slice(1,e.length),v:Ne(r,Be(t))})));var r,o})),o=_e(e,"attributes").map((e=>{return r=t,o=Ve(e),J(o,((e,t)=>({k:e.slice(1,e.length),v:Me(r,t)})));var r,o})),n={...r.getOr({}),...o.getOr({})};return X(n).every((e=>""!==e))?b.some(n):b.none()})(e,r))).map((e=>({kind:pe.SubstitutionSchema,formatName:t,substitutedVariables:e})));var o})(e.formatter,r,t).toArray()))))},$e=e=>(e=>O(X(ve),(t=>e.queryCommandState(t))))(e).map((e=>({kind:pe.ListSchema,command:e}))),qe=(e,t)=>e.getParent(t,"TABLE")?be.Table:be.Unspecified,ze=(t,r,o)=>{t.addCommand("mceToggleFormatPainter",(()=>{((t,r)=>{r.get()===fe.Application?Se(t,r):((t,r)=>{const o=K(),n=e(!1);ye(t),r.set(fe.Application),he(t,!0),t.execCommand("mceRetrieveFormats");const s=()=>{t.execCommand("mcePaintFormats"),Se(t,r)},i=()=>{r.get()===fe.Application&&s(),m()},a=e=>{r.get()===fe.Application&&("touchcancel"===e.type&&o.os.isAndroid()?t.once("contextmenu",s):n.get()?s():t.once("selectionchange",s)),m()},c=e=>{27===e.keyCode&&(Se(t,r),m())},l=e=>{n.set("touchmove"===e.type)};t.on("click",i),t.on("touchstart touchmove",l),t.on("touchend touchcancel",a),t.on("keydown",c);const m=()=>{t.off("click",i),t.off("touchstart touchmove",l),t.off("touchend touchcancel",a),t.off("keydown",c)}})(t,r)})(t,r)})),t.addCommand("mcePaintFormats",(()=>{t.selection.isEditable()&&t.undoManager.transact((()=>{((e,t)=>{((e,t)=>{e.formatter.remove("formatpainter_removeformat"),t===be.Table&&(t=>{for(let o=0,n=t.length;o<n;o++)r=t[o],e.formatter.remove(r);var r})(["formatpainter_borderstyle","formatpainter_bordercolor","formatpainter_backgroundcolor"]),De(e)&&e.execCommand("RemoveList")})(e,t.context);const r=(e=>{const t=e.selection.getStart(),r=e.selection.getRng().collapsed,o=e.dom.select("td[data-mce-selected]").length>0,n=!!e.dom.getParent(t,"TABLE");return{inline:!0,table:r&&n||o,block:r||(s=e.selection,s.getSelectedBlocks().length>1)||o};var s})(e);t.schemas.forEach((t=>{switch(t.kind){case pe.ListSchema:((e,t,r)=>{r.block&&e.execCommand(t.command)})(e,t,r);break;case pe.SubstitutionSchema:Ee(e,r,t)}}))})(t,o.get())}))})),t.addCommand("mceRetrieveFormats",(()=>{o.set((e=>{const t=e.dom,r=e.selection.getStart();return{schemas:[...$e(e).toArray(),...We(e,r)],context:qe(t,r)}})(t))}))};tinymce.PluginManager.add("formatpainter",(t=>{if(((e,t)=>!!e&&-1===((e,t)=>{const o=r(e.major,t.major);if(0!==o)return o;const n=r(e.minor,t.minor);if(0!==n)return n;const s=r(e.patch,t.patch);return 0!==s?s:0})((e=>n((e=>[e.majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."))(e)))(e),n(t)))(tinymce,"6.0.0"))return void window.console.error("The format painter plugin requires at least version 6.0.0 of TinyMCE.");const o=e(fe.Retrival),s=e({schemas:[],context:be.Unspecified});(e=>{(0,e.options.register)("formatpainter_ignored_formats",{processor:"string[]",default:"link,address,removeformat,formatpainter_removeformat".split(",")})})(t),(e=>{e.on("PreInit",(()=>{H(Le,((t,r)=>{e.formatter.get(r)||e.formatter.register(r,t)}))}))})(t),ze(t,o,s),(e=>{e.ui.registry.addToggleButton("formatpainter",{active:!1,icon:"format-painter",tooltip:"Format painter",onAction:()=>e.execCommand("mceToggleFormatPainter"),onSetup:t=>{const r=e=>{t.setActive(e.state)};return e.on("FormatPainterToggle",r),()=>e.off("FormatPainterToggle",r)}})})(t),((e,t)=>{e.ui.registry.addToggleMenuItem("formatpainter",{active:!1,icon:"format-painter",text:"Format painter",onAction:()=>e.execCommand("mceToggleFormatPainter"),onSetup:r=>{const o=e=>{r.setActive(e.state)};return r.setActive(t.get()===fe.Application),e.on("FormatPainterToggle",o),()=>e.off("FormatPainterToggle",o)}})})(t,o),(e=>{e.addShortcut("Meta+alt+C","",(()=>{e.execCommand("mceRetrieveFormats")})),e.addShortcut("Meta+alt+V","",(()=>{e.execCommand("mcePaintFormats")}))})(t)}))}();
