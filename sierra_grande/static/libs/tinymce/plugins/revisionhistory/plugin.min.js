/*!
 * Tiny Revision History plugin
 *
 * Copyright (c) 2024 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 7.8.0-392
 */

!function(){"use strict";const e=e=>parseInt(e,10),t=(e,t)=>{const n=e-t;return 0===n?0:n>0?1:-1},n=(e,t,n)=>({major:e,minor:t,patch:n}),r=t=>{const r=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t);return r?n(e(r[1]),e(r[2]),e(r[3])):n(0,0,0)},o=e=>t=>typeof t===e,i=e=>"string"===(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&((e,t)=>{var n;return!!((e,t)=>t.isPrototypeOf(e))(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name})(e,String)?"string":t})(e),s=o("boolean"),a=e=>void 0===e,l=e=>null==e,c=e=>!l(e),h=o("function"),f=o("number"),u=()=>{},_=e=>()=>e,d=(e,t)=>e===t,g=_(!1),p=_(!0);class m{constructor(e,t){this.tag=e,this.value=t}static some(e){return new m(!0,e)}static none(){return m.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?m.some(e(this.value)):m.none()}bind(e){return this.tag?e(this.value):m.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:m.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return c(e)?m.some(e):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const v=Array.prototype.slice,y=Array.prototype.indexOf,b=(e,t)=>((e,t)=>y.call(e,t))(e,t)>-1,w=(e,t)=>{const n=e.length,r=new Array(n);for(let o=0;o<n;o++){const n=e[o];r[o]=t(n,o)}return r},x=(e,t)=>{for(let n=0,r=e.length;n<r;n++)t(e[n],n)},S=(e,t)=>{const n=[];for(let r=0,o=e.length;r<o;r++){const o=e[r];t(o,r)&&n.push(o)}return n},k=(e,t,n)=>(x(e,((e,r)=>{n=t(n,e,r)})),n),C=(e,t)=>((e,t,n)=>{for(let r=0,o=e.length;r<o;r++){const o=e[r];if(t(o,r))return m.some(o);if(n(o,r))break}return m.none()})(e,t,g),M=(e,t)=>{for(let n=0,r=e.length;n<r;n++)if(t(e[n],n))return m.some(n);return m.none()},D=e=>{const t=v.call(e,0);return t.reverse(),t},A=(e,t)=>{const n=v.call(e,0);return n.sort(t),n},E=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),N=e=>E(e,0),R=e=>E(e,e.length-1),T=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},I=(e,t)=>{const n=(t||document).createElement(e);return T(n)},O=(e,t)=>{const n=(t||document).createTextNode(e);return T(n)},P=T,U=(e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},F=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,H=(e,t)=>e.dom===t.dom;"undefined"!=typeof window?window:Function("return this;")();const L=e=>e.dom.nodeName.toLowerCase(),j=e=>e.dom.nodeType,$=e=>t=>j(t)===e,B=$(1),V=$(3),W=$(9),K=$(11),z=e=>P(e.dom.ownerDocument),q=e=>W(e)?e:z(e),G=e=>m.from(e.dom.parentNode).map(P),X=e=>G(e),Y=e=>m.from(e.dom.previousSibling).map(P),Z=e=>m.from(e.dom.nextSibling).map(P),J=e=>w(e.dom.childNodes,P),Q=e=>(e=>{const t=e.dom.childNodes;return m.from(t[0]).map(P)})(e),ee=(e,t)=>{G(e).each((n=>{n.dom.insertBefore(t.dom,e.dom)}))},te=(e,t)=>{e.dom.appendChild(t.dom)},ne=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},re=(e,t)=>{const n=(t||document).createElement("div");return n.innerHTML=e,J(P(n))},oe=e=>e.dom.innerHTML,ie=e=>{const t=I("div"),n=P(e.dom.cloneNode(!0));return te(t,n),oe(t)},se=(e,t)=>{const n=(t||document).createDocumentFragment();return x(e,(e=>{n.appendChild(e.dom)})),P(n)},ae=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},le=-1;(ae.Diff=function(e,t){this[0]=e,this[1]=t}).prototype.length=2,ae.Diff.prototype.toString=function(){return this[0]+","+this[1]},ae.Diff.prototype[Symbol.iterator]=function*(){yield this[0],yield this[1]},ae.prototype.diff_main=function(e,t,n,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new ae.Diff(0,e)]:[];void 0===n&&(n=!0);var i=n,s=this.diff_commonPrefix(e,t),a=e.substring(0,s);e=e.substring(s),t=t.substring(s),s=this.diff_commonSuffix(e,t);var l=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var c=this.diff_compute_(e,t,i,o);return a&&c.unshift(new ae.Diff(0,a)),l&&c.push(new ae.Diff(0,l)),this.diff_cleanupMerge(c),c},ae.prototype.diff_compute_=function(e,t,n,r){var o;if(!e)return[new ae.Diff(1,t)];if(!t)return[new ae.Diff(le,e)];var i=e.length>t.length?e:t,s=e.length>t.length?t:e,a=i.indexOf(s);if(-1!=a)return o=[new ae.Diff(1,i.substring(0,a)),new ae.Diff(0,s),new ae.Diff(1,i.substring(a+s.length))],e.length>t.length&&(o[0][0]=o[2][0]=le),o;if(1==s.length)return[new ae.Diff(le,e),new ae.Diff(1,t)];var l=this.diff_halfMatch_(e,t);if(l){var c=l[0],h=l[1],f=l[2],u=l[3],_=l[4],d=this.diff_main(c,f,n,r),g=this.diff_main(h,u,n,r);return d.concat([new ae.Diff(0,_)],g)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},ae.prototype.diff_lineMode_=function(e,t,n){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var o=r.lineArray,i=this.diff_main(e,t,!1,n);this.diff_charsToLines_(i,o),this.diff_cleanupSemantic(i),i.push(new ae.Diff(0,""));for(var s=0,a=0,l=0,c="",h="";s<i.length;){switch(i[s][0]){case 1:l++,h+=i[s][1];break;case le:a++,c+=i[s][1];break;case 0:if(a>=1&&l>=1){i.splice(s-a-l,a+l),s=s-a-l;for(var f=this.diff_main(c,h,!1,n),u=f.length-1;u>=0;u--)i.splice(s,0,f[u]);s+=f.length}l=0,a=0,c="",h=""}s++}return i.pop(),i},ae.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,o=t.length,i=Math.ceil((r+o)/2),s=i,a=2*i,l=new Array(a),c=new Array(a),h=0;h<a;h++)l[h]=-1,c[h]=-1;l[s+1]=0,c[s+1]=0;for(var f=r-o,u=f%2!=0,_=0,d=0,g=0,p=0,m=0;m<i&&!((new Date).getTime()>n);m++){for(var v=-m+_;v<=m-d;v+=2){for(var y=s+v,b=(C=v==-m||v!=m&&l[y-1]<l[y+1]?l[y+1]:l[y-1]+1)-v;C<r&&b<o&&e.charAt(C)==t.charAt(b);)C++,b++;if(l[y]=C,C>r)d+=2;else if(b>o)_+=2;else if(u&&(S=s+f-v)>=0&&S<a&&-1!=c[S]&&C>=(x=r-c[S]))return this.diff_bisectSplit_(e,t,C,b,n)}for(var w=-m+g;w<=m-p;w+=2){for(var x,S=s+w,k=(x=w==-m||w!=m&&c[S-1]<c[S+1]?c[S+1]:c[S-1]+1)-w;x<r&&k<o&&e.charAt(r-x-1)==t.charAt(o-k-1);)x++,k++;if(c[S]=x,x>r)p+=2;else if(k>o)g+=2;else if(!u){var C;if((y=s+f-w)>=0&&y<a&&-1!=l[y])if(b=s+(C=l[y])-y,C>=(x=r-x))return this.diff_bisectSplit_(e,t,C,b,n)}}}return[new ae.Diff(le,e),new ae.Diff(1,t)]},ae.prototype.diff_bisectSplit_=function(e,t,n,r,o){var i=e.substring(0,n),s=t.substring(0,r),a=e.substring(n),l=t.substring(r),c=this.diff_main(i,s,!1,o),h=this.diff_main(a,l,!1,o);return c.concat(h)},ae.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function o(e){for(var t="",o=0,s=-1,a=n.length;s<e.length-1;){-1==(s=e.indexOf("\n",o))&&(s=e.length-1);var l=e.substring(o,s+1);(r.hasOwnProperty?r.hasOwnProperty(l):void 0!==r[l])?t+=String.fromCharCode(r[l]):(a==i&&(l=e.substring(o),s=e.length),t+=String.fromCharCode(a),r[l]=a,n[a++]=l),o=s+1}return t}n[0]="";var i=4e4,s=o(e);return i=65535,{chars1:s,chars2:o(t),lineArray:n}},ae.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],o=[],i=0;i<r.length;i++)o[i]=t[r.charCodeAt(i)];e[n][1]=o.join("")}},ae.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(i,o)==t.substring(i,o)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o},ae.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o},ae.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var o=Math.min(n,r);if(e==t)return o;for(var i=0,s=1;;){var a=e.substring(o-s),l=t.indexOf(a);if(-1==l)return i;s+=l,0!=l&&e.substring(o-s)!=t.substring(0,s)||(i=s,s++)}},ae.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var o=this;function i(e,t,n){for(var r,i,s,a,l=e.substring(n,n+Math.floor(e.length/4)),c=-1,h="";-1!=(c=t.indexOf(l,c+1));){var f=o.diff_commonPrefix(e.substring(n),t.substring(c)),u=o.diff_commonSuffix(e.substring(0,n),t.substring(0,c));h.length<u+f&&(h=t.substring(c-u,c)+t.substring(c,c+f),r=e.substring(0,n-u),i=e.substring(n+f),s=t.substring(0,c-u),a=t.substring(c+f))}return 2*h.length>=e.length?[r,i,s,a,h]:null}var s,a,l,c,h,f=i(n,r,Math.ceil(n.length/4)),u=i(n,r,Math.ceil(n.length/2));return f||u?(s=u?f&&f[4].length>u[4].length?f:u:f,e.length>t.length?(a=s[0],l=s[1],c=s[2],h=s[3]):(c=s[0],h=s[1],a=s[2],l=s[3]),[a,l,c,h,s[4]]):null},ae.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,o=null,i=0,s=0,a=0,l=0,c=0;i<e.length;)0==e[i][0]?(n[r++]=i,s=l,a=c,l=0,c=0,o=e[i][1]):(1==e[i][0]?l+=e[i][1].length:c+=e[i][1].length,o&&o.length<=Math.max(s,a)&&o.length<=Math.max(l,c)&&(e.splice(n[r-1],0,new ae.Diff(le,o)),e[n[r-1]+1][0]=1,r--,i=--r>0?n[r-1]:-1,s=0,a=0,l=0,c=0,o=null,t=!0)),i++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),i=1;i<e.length;){if(e[i-1][0]==le&&1==e[i][0]){var h=e[i-1][1],f=e[i][1],u=this.diff_commonOverlap_(h,f),_=this.diff_commonOverlap_(f,h);u>=_?(u>=h.length/2||u>=f.length/2)&&(e.splice(i,0,new ae.Diff(0,f.substring(0,u))),e[i-1][1]=h.substring(0,h.length-u),e[i+1][1]=f.substring(u),i++):(_>=h.length/2||_>=f.length/2)&&(e.splice(i,0,new ae.Diff(0,h.substring(0,_))),e[i-1][0]=1,e[i-1][1]=f.substring(0,f.length-_),e[i+1][0]=le,e[i+1][1]=h.substring(_),i++),i++}i++}},ae.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),r=t.charAt(0),o=n.match(ae.nonAlphaNumericRegex_),i=r.match(ae.nonAlphaNumericRegex_),s=o&&n.match(ae.whitespaceRegex_),a=i&&r.match(ae.whitespaceRegex_),l=s&&n.match(ae.linebreakRegex_),c=a&&r.match(ae.linebreakRegex_),h=l&&e.match(ae.blanklineEndRegex_),f=c&&t.match(ae.blanklineStartRegex_);return h||f?5:l||c?4:o&&!s&&a?3:s||a?2:o||i?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var r=e[n-1][1],o=e[n][1],i=e[n+1][1],s=this.diff_commonSuffix(r,o);if(s){var a=o.substring(o.length-s);r=r.substring(0,r.length-s),o=a+o.substring(0,o.length-s),i=a+i}for(var l=r,c=o,h=i,f=t(r,o)+t(o,i);o.charAt(0)===i.charAt(0);){r+=o.charAt(0),o=o.substring(1)+i.charAt(0),i=i.substring(1);var u=t(r,o)+t(o,i);u>=f&&(f=u,l=r,c=o,h=i)}e[n-1][1]!=l&&(l?e[n-1][1]=l:(e.splice(n-1,1),n--),e[n][1]=c,h?e[n+1][1]=h:(e.splice(n+1,1),n--))}n++}},ae.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,ae.whitespaceRegex_=/\s/,ae.linebreakRegex_=/[\r\n]/,ae.blanklineEndRegex_=/\n\r?\n$/,ae.blanklineStartRegex_=/^\r?\n\r?\n/,ae.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,o=null,i=0,s=!1,a=!1,l=!1,c=!1;i<e.length;)0==e[i][0]?(e[i][1].length<this.Diff_EditCost&&(l||c)?(n[r++]=i,s=l,a=c,o=e[i][1]):(r=0,o=null),l=c=!1):(e[i][0]==le?c=!0:l=!0,o&&(s&&a&&l&&c||o.length<this.Diff_EditCost/2&&s+a+l+c==3)&&(e.splice(n[r-1],0,new ae.Diff(le,o)),e[n[r-1]+1][0]=1,r--,o=null,s&&a?(l=c=!0,r=0):(i=--r>0?n[r-1]:-1,l=c=!1),t=!0)),i++;t&&this.diff_cleanupMerge(e)},ae.prototype.diff_cleanupMerge=function(e){e.push(new ae.Diff(0,""));for(var t,n=0,r=0,o=0,i="",s="";n<e.length;)switch(e[n][0]){case 1:o++,s+=e[n][1],n++;break;case le:r++,i+=e[n][1],n++;break;case 0:r+o>1?(0!==r&&0!==o&&(0!==(t=this.diff_commonPrefix(s,i))&&(n-r-o>0&&0==e[n-r-o-1][0]?e[n-r-o-1][1]+=s.substring(0,t):(e.splice(0,0,new ae.Diff(0,s.substring(0,t))),n++),s=s.substring(t),i=i.substring(t)),0!==(t=this.diff_commonSuffix(s,i))&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),i=i.substring(0,i.length-t))),n-=r+o,e.splice(n,r+o),i.length&&(e.splice(n,0,new ae.Diff(le,i)),n++),s.length&&(e.splice(n,0,new ae.Diff(1,s)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,o=0,r=0,i="",s=""}""===e[e.length-1][1]&&e.pop();var a=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),a=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),a=!0)),n++;a&&this.diff_cleanupMerge(e)},ae.prototype.diff_cleanupSplitSurrogates=function(e){for(var t,n=0;n<e.length;n++){var r=e[n],o=r[1][0],i=r[1][r[1].length-1];0!==r[1].length?(i&&this.isHighSurrogate(i)&&(t=i,r[1]=r[1].slice(0,-1)),t&&o&&this.isHighSurrogate(t)&&this.isLowSurrogate(o)&&(r[1]=t+r[1]),0!==r[1].length||e.splice(n--,1)):e.splice(n--,1)}return e},ae.prototype.isHighSurrogate=function(e){var t=e.charCodeAt(0);return t>=55296&&t<=56319},ae.prototype.isLowSurrogate=function(e){var t=e.charCodeAt(0);return t>=56320&&t<=57343},ae.prototype.digit16=function(e){switch(e){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"A":case"a":return 10;case"B":case"b":return 11;case"C":case"c":return 12;case"D":case"d":return 13;case"E":case"e":return 14;case"F":case"f":return 15;default:throw new Error("Invalid hex-code")}},ae.prototype.decodeURI=function(e){try{return decodeURI(e)}catch(l){for(var t=0,n="";t<e.length;)if("%"===e[t]){var r=(this.digit16(e[t+1])<<4)+this.digit16(e[t+2]);if(128&r){if("%"!==e[t+3])throw new URIError("URI malformed");var o=(this.digit16(e[t+4])<<4)+this.digit16(e[t+5]);if(128!=(192&o))throw new URIError("URI malformed");if(o&=63,192!=(224&r)){if("%"!==e[t+6])throw new URIError("URI malformed");var i=(this.digit16(e[t+7])<<4)+this.digit16(e[t+8]);if(128!=(192&i))throw new URIError("URI malformed");if(i&=63,224!=(240&r)){if("%"!==e[t+9])throw new URIError("URI malformed");var s=(this.digit16(e[t+10])<<4)+this.digit16(e[t+11]);if(128!=(192&s))throw new URIError("URI malformed");if(s&=63,240==(248&r)){var a=(7&r)<<18|o<<12|i<<6|s;if(a>=65536&&a<=1114111){n+=String.fromCharCode((65535&a)>>>10&1023|55296),n+=String.fromCharCode(56320|1023&a),t+=12;continue}}throw new URIError("URI malformed")}n+=String.fromCharCode((15&r)<<12|o<<6|i),t+=9}else n+=String.fromCharCode((31&r)<<6|o),t+=6}else n+=String.fromCharCode(r),t+=3}else n+=e[t++];return n}},ae.prototype.diff_xIndex=function(e,t){var n,r=0,o=0,i=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),e[n][0]!==le&&(o+=e[n][1].length),!(r>t));n++)i=r,s=o;return e.length!=n&&e[n][0]===le?s:s+(t-i)},ae.prototype.diff_prettyHtml=function(e){e=this.diff_cleanupSplitSurrogates(e);for(var t=[],n=/&/g,r=/</g,o=/>/g,i=/\n/g,s=0;s<e.length;s++){var a=e[s][0],l=e[s][1].replace(n,"&amp;").replace(r,"&lt;").replace(o,"&gt;").replace(i,"&para;<br>");switch(a){case 1:t[s]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case le:t[s]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[s]="<span>"+l+"</span>"}}return t.join("")},ae.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},ae.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==le&&(t[n]=e[n][1]);return t.join("")},ae.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,o=0;o<e.length;o++){var i=e[o][0],s=e[o][1];switch(i){case 1:n+=s.length;break;case le:r+=s.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+Math.max(n,r)},ae.prototype.diff_toDelta=function(e){e=this.diff_cleanupSplitSurrogates(e);for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case le:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},ae.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,o=0,i=t.split(/\t/g),s=0;s<i.length;s++){var a=i[s].substring(1);switch(i[s].charAt(0)){case"+":try{n[r++]=new ae.Diff(1,this.decodeURI(a))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+a)}break;case"-":case"=":var l=parseInt(a,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+a);var c=e.substring(o,o+=l);"="==i[s].charAt(0)?n[r++]=new ae.Diff(0,c):n[r++]=new ae.Diff(le,c);break;default:if(i[s])throw new Error("Invalid diff operation in diff_fromDelta: "+i[s])}}if(o!=e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return n},ae.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},ae.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),o=this;function i(e,r){var i=e/t.length,s=Math.abs(n-r);return o.Match_Distance?i+s/o.Match_Distance:s?1:i}var s=this.Match_Threshold,a=e.indexOf(t,n);-1!=a&&(s=Math.min(i(0,a),s),-1!=(a=e.lastIndexOf(t,n+t.length))&&(s=Math.min(i(0,a),s)));var l,c,h=1<<t.length-1;a=-1;for(var f,u=t.length+e.length,_=0;_<t.length;_++){for(l=0,c=u;l<c;)i(_,n+c)<=s?l=c:u=c,c=Math.floor((u-l)/2+l);u=c;var d=Math.max(1,n-c+1),g=Math.min(n+c,e.length)+t.length,p=Array(g+2);p[g+1]=(1<<_)-1;for(var m=g;m>=d;m--){var v=r[e.charAt(m-1)];if(p[m]=0===_?(p[m+1]<<1|1)&v:(p[m+1]<<1|1)&v|(f[m+1]|f[m])<<1|1|f[m+1],p[m]&h){var y=i(_,m-1);if(y<=s){if(s=y,!((a=m-1)>n))break;d=Math.max(1,2*n-a)}}}if(i(_+1,n)>s)break;f=p}return a},ae.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},ae.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin,e.start2-r>0&&ae.prototype.isLowSurrogate(t[e.start2-r])&&r++;var o=t.substring(e.start2-r,e.start2);o&&e.diffs.unshift(new ae.Diff(0,o)),e.start2+e.length1+r<t.length&&ae.prototype.isHighSurrogate(t[e.start2+e.length1+r])&&r++;var i=t.substring(e.start2+e.length1,e.start2+e.length1+r);i&&e.diffs.push(new ae.Diff(0,i)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+i.length,e.length2+=o.length+i.length}},ae.prototype.patch_make=function(e,t,n){var r,o;if("string"==typeof e&&"string"==typeof t&&void 0===n)r=e,(o=this.diff_main(r,t,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===t&&void 0===n)o=e,r=this.diff_text1(o);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===n)r=e,o=t;else{if("string"!=typeof e||"string"!=typeof t||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,o=n}if(0===o.length)return[];o=this.diff_cleanupSplitSurrogates(o);for(var i=[],s=new ae.patch_obj,a=0,l=0,c=0,h=r,f=r,u=0;u<o.length;u++){var _=o[u][0],d=o[u][1];switch(a||0===_||(s.start1=l,s.start2=c),_){case 1:s.diffs[a++]=o[u],s.length2+=d.length,f=f.substring(0,c)+d+f.substring(c);break;case le:s.length1+=d.length,s.diffs[a++]=o[u],f=f.substring(0,c)+f.substring(c+d.length);break;case 0:d.length<=2*this.Patch_Margin&&a&&o.length!=u+1?(s.diffs[a++]=o[u],s.length1+=d.length,s.length2+=d.length):d.length>=2*this.Patch_Margin&&a&&(this.patch_addContext_(s,h),i.push(s),s=new ae.patch_obj,a=0,h=f,l=c)}1!==_&&(l+=d.length),_!==le&&(c+=d.length)}return a&&(this.patch_addContext_(s,h),i.push(s)),i},ae.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=new ae.patch_obj;o.diffs=[];for(var i=0;i<r.diffs.length;i++)o.diffs[i]=new ae.Diff(r.diffs[i][0],r.diffs[i][1]);o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,t[n]=o}return t},ae.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,o=[],i=0;i<e.length;i++){var s,a,l=e[i].start2+r,c=this.diff_text1(e[i].diffs),h=-1;if(c.length>this.Match_MaxBits?-1!=(s=this.match_main(t,c.substring(0,this.Match_MaxBits),l))&&(-1==(h=this.match_main(t,c.substring(c.length-this.Match_MaxBits),l+c.length-this.Match_MaxBits))||s>=h)&&(s=-1):s=this.match_main(t,c,l),-1==s)o[i]=!1,r-=e[i].length2-e[i].length1;else if(o[i]=!0,r=s-l,c==(a=-1==h?t.substring(s,s+c.length):t.substring(s,h+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[i].diffs)+t.substring(s+c.length);else{var f=this.diff_main(c,a,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(f)/c.length>this.Patch_DeleteThreshold)o[i]=!1;else{this.diff_cleanupSemanticLossless(f);for(var u,_=0,d=0;d<e[i].diffs.length;d++){var g=e[i].diffs[d];0!==g[0]&&(u=this.diff_xIndex(f,_)),1===g[0]?t=t.substring(0,s+u)+g[1]+t.substring(s+u):g[0]===le&&(t=t.substring(0,s+u)+t.substring(s+this.diff_xIndex(f,_+g[1].length))),g[0]!==le&&(_+=g[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),o]},ae.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var o=e[0],i=o.diffs;if(0==i.length||0!=i[0][0])i.unshift(new ae.Diff(0,n)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>i[0][1].length){var s=t-i[0][1].length;i[0][1]=n.substring(i[0][1].length)+i[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}return 0==(i=(o=e[e.length-1]).diffs).length||0!=i[i.length-1][0]?(i.push(new ae.Diff(0,n)),o.length1+=t,o.length2+=t):t>i[i.length-1][1].length&&(s=t-i[i.length-1][1].length,i[i.length-1][1]+=n.substring(0,s),o.length1+=s,o.length2+=s),n},ae.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var r=e[n];e.splice(n--,1);for(var o=r.start1,i=r.start2,s="";0!==r.diffs.length;){var a=new ae.patch_obj,l=!0;for(a.start1=o-s.length,a.start2=i-s.length,""!==s&&(a.length1=a.length2=s.length,a.diffs.push(new ae.Diff(0,s)));0!==r.diffs.length&&a.length1<t-this.Patch_Margin;){var c=r.diffs[0][0],h=r.diffs[0][1];1===c?(a.length2+=h.length,i+=h.length,a.diffs.push(r.diffs.shift()),l=!1):c===le&&1==a.diffs.length&&0==a.diffs[0][0]&&h.length>2*t?(a.length1+=h.length,o+=h.length,l=!1,a.diffs.push(new ae.Diff(c,h)),r.diffs.shift()):(h=h.substring(0,t-a.length1-this.Patch_Margin),a.length1+=h.length,o+=h.length,0===c?(a.length2+=h.length,i+=h.length):l=!1,a.diffs.push(new ae.Diff(c,h)),h==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(h.length))}s=(s=this.diff_text2(a.diffs)).substring(s.length-this.Patch_Margin);var f=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==f&&(a.length1+=f.length,a.length2+=f.length,0!==a.diffs.length&&0===a.diffs[a.diffs.length-1][0]?a.diffs[a.diffs.length-1][1]+=f:a.diffs.push(new ae.Diff(0,f))),l||e.splice(++n,0,a)}}},ae.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},ae.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),r=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var i=n[r].match(o);if(!i)throw new Error("Invalid patch string: "+n[r]);var s=new ae.patch_obj;for(t.push(s),s.start1=parseInt(i[1],10),""===i[2]?(s.start1--,s.length1=1):"0"==i[2]?s.length1=0:(s.start1--,s.length1=parseInt(i[2],10)),s.start2=parseInt(i[3],10),""===i[4]?(s.start2--,s.length2=1):"0"==i[4]?s.length2=0:(s.start2--,s.length2=parseInt(i[4],10)),r++;r<n.length;){var a=n[r].charAt(0);try{var l=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==a)s.diffs.push(new ae.Diff(le,l));else if("+"==a)s.diffs.push(new ae.Diff(1,l));else if(" "==a)s.diffs.push(new ae.Diff(0,l));else{if("@"==a)break;if(""!==a)throw new Error('Invalid patch mode "'+a+'" in: '+l)}r++}}return t},(ae.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"];ae.prototype.diff_cleanupSplitSurrogates(this.diffs);for(var n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case le:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")};const ce=Object.keys,he=Object.hasOwnProperty,fe=(e,t,n)=>{((e,t,n)=>{if(!(i(n)||s(n)||f(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")})(e.dom,t,n)},ue=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},_e=(e,t)=>m.from(ue(e,t)),de=(e,t)=>{e.dom.removeAttribute(t)},ge=(e,t)=>P(e.dom.cloneNode(t)),pe=e=>ge(e,!1),me=e=>ge(e,!0),ve=e=>P(e.dom.getRootNode()),ye=e=>P(e.dom.host),be=e=>{const t=V(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const n=t.ownerDocument;return(e=>{const t=ve(e);return K(n=t)&&c(n.dom.host)?m.some(t):m.none();var n})(P(t)).fold((()=>n.body.contains(t)),(r=be,o=ye,e=>r(o(e))));var r,o},we=(e,t)=>((e,t)=>{const n=void 0===t?document:t.dom;return F(n)?[]:w(n.querySelectorAll(e),P)})(t,e),xe=(e,t)=>e?m.some(t):m.none(),Se=(e,t)=>{const n=ue(e,t);return void 0===n||""===n?[]:n.split(" ")},ke=e=>void 0!==e.dom.classList,Ce=(e,t)=>{ke(e)?e.dom.classList.add(t):((e,t)=>{((e,t,n)=>{const r=Se(e,t).concat([n]);fe(e,t,r.join(" "))})(e,"class",t)})(e,t)},Me=e=>B(e),De=e=>V(e),Ae=(e,t)=>e===t,Ee=e=>{if(e.dom.getAttributeNames)return A(e.dom.getAttributeNames());const t=(e=>k(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}))(e);return A(ce(t))},Ne=(e,t)=>{const n=L(e);return n===L(t)&&b(["img","iframe","audio","video","embed","source"],n)&&((e,t,n=d)=>((e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none())(e,t,n).getOr(e.isNone()&&t.isNone()))(_e(e,"src"),_e(t,"src"))},Re=(e,t,n=!1)=>{if(H(e,t))return!0;if(j(e)!==j(t)||L(e)!==L(t))return!1;if(De(e)||(8===j(r=e)||"#comment"===L(r))){if(e.dom.data!==t.dom.data)return!1}else if(Me(e)){const n=Ee(e);if(!((e,t,n=Ae)=>{if(e.length!==t.length)return!1;for(let r=0,o=e.length;r<o;++r)if(!n(e[r],t[r]))return!1;return!0})(n,Ee(t)))return!1;for(let r=0,o=n.length;r<o;++r){const o=n[r];if(ue(e,o)!==ue(t,o))return!1}}var r;if(n){const r=J(e),o=J(t);if(r.length!==o.length)return!1;for(let e=0,t=r.length;e<t;++e)if(!Re(r[e],o[e],n))return!1}return!0},Te=(e,t=m.none())=>{const n=e=>t.exists((t=>H(e,t)));return n(e)?[]:((e,t)=>{const n=h(t)?t:g;let r=e.dom;const o=[];for(;null!==r.parentNode&&void 0!==r.parentNode;){const e=r.parentNode,t=P(e);if(o.push(t),!0===n(t))break;r=e}return o})(e,n)},Ie=(e="visual-dom-diff: An error occurred when trying to calculate the diff between content")=>{throw new Error(e)},Oe=e=>{for(let t=0;t<e.length-2;){const n=e[t],r=e[t+1],o=e[t+2];if(0!==n[0]||0===r[0]||0!==o[0]){t++;continue}const i=n[1],s=r[1],a=o[1],l=i[i.length-1];l!==s[s.length-1]||l<"\ue000"||l>="\uf900"?t++:(n[1]=i.substring(0,i.length-1),r[1]=l+s.substring(0,s.length-1),o[1]=l+a,0===n[1].length&&e.splice(t,1))}},Pe=new ae,Ue=(e,t)=>{const n=Pe.diff_main(e,t),r=[],o=[];Oe(n);for(let e=0,t=n.length;e<t;++e){const t=n[e];if(0===t[0]){const e=t[1],n=e.length,i=m.from(/^[^\uE000-\uF8FF]*/.exec(e)).map((e=>e[0].length)).getOr(0);if(i<n){const t=m.from(/[^\uE000-\uF8FF]*$/.exec(e)).map((e=>e[0].length)).getOr(0);i>0&&o.push(new ae.Diff(0,e.substring(0,i))),Pe.diff_cleanupSemantic(o),Fe(r,o),o.length=0,r.push(new ae.Diff(0,e.substring(i,n-t))),t>0&&o.push(new ae.Diff(0,e.substring(n-t)))}else o.push(t)}else o.push(t)}return Pe.diff_cleanupSemantic(o),Fe(r,o),o.length=0,Pe.diff_cleanupMerge(r),Oe(r),r},Fe=(e,t)=>{Array.prototype.push.apply(e,t)},He=(e,t,n)=>{if(Me(e))Ce(e,n);else{const r=q(e);Y(e).filter((e=>{return L(e)===t&&(o=n,ke(r=e)&&r.dom.classList.contains(o));var r,o})).fold((()=>{const o=I(t,r.dom);Ce(o,n),ee(e,o),te(o,e)}),(t=>te(t,e)))}},Le=(e,t)=>{let n;const r=e=>{const t=L(e);return"th"===t||"td"===t},o=(e,o)=>{const i=L(e),s=J(e);if("tr"!==i||0===s.length)return!1;const l=e=>k(e,((e,t)=>{if(!Me(t))return{columns:e.columns+1,rowspan:e.rowspan+1};const n=_e(t,"colspan").map((e=>parseInt(e,10))).getOr(1);return{columns:e.columns+n,rowspan:e.rowspan+_e(t,"rowspan").map((e=>parseInt(e,10)-1)).getOr(0)*n}}),{columns:0,rowspan:0});if(t)if(a(n))n=l(s);else{const e=l(s);if(n.rowspan>0){const t=e.columns+n.rowspan-n.columns<0,r=o&&n.rowspan+e.columns>n.columns;if(t||r)return!1;{const t=n.columns-e.columns;n={columns:n.columns,rowspan:n.rowspan-t+e.rowspan}}}else{if(n.columns!==e.columns)return!1;n=e}}for(let e=0,t=s.length;e<t;++e)if(!r(s[e]))return!1;return!0},i=e=>{const t=L(e),n=J(e);if("tbody"===t&&0===n.length)return!1;for(let e=0,t=n.length;e<t;++e){const t=n.length-1===e;if(!o(n[e],t))return!1}return!0};return(e=>{const t=J(e),n=t.length;let r=0;if(r<n&&"caption"===L(t[r])&&r++,r<n&&"thead"===L(t[r])){if(!i(t[r]))return!1;r++}if(!(r<n&&"tbody"===L(t[r])))return!1;if(!i(t[r]))return!1;if(r++,r<n&&"tfoot"===L(t[r])){if(!i(t[r]))return!1;r++}return r===n})(e)},je=(e,t)=>{let n=!1;for(const r of e)if(H(r,t)){n=!0;break}return n},$e=(e,t)=>{let n=null;const r=Array.from(e.entries());for(const[e,o]of r)if(H(e,t)){n=o;break}return m.from(n)},Be=(e,t)=>{const n=J(e),r=J(t);for(let e=0;e<Math.min(n.length,r.length);e++){const t=n[e],o=r[e];if(Me(t)&&Me(o)){const e=ue(t,"colspan")||"1",n=ue(o,"colspan")||"1",r=ue(t,"rowspan")||"1",i=ue(o,"rowspan")||"1";if(e!==n||r!==i)return!1}}return!0},Ve=new Set(["img","video","iframe","object","svg"]),We=new Set(["bdo","bdi","q","cite","code","data","time","var","dfn","abbr","strong","em","big","small","mark","sub","sup","samp","kbd","b","i","s","u","span"]),Ke=({addedClass:e="vdd-added",modifiedClass:t="vdd-modified",removedClass:n="vdd-removed",skipModified:r=!1,skipChildren:o,skipSelf:i,diffText:s=Ue}={})=>({addedClass:e,diffText:s,modifiedClass:t,removedClass:n,skipModified:r,skipChildren:e=>{if(!Me(e)&&!(e=>K(e))(e)&&!(e=>W(e))(e))return!0;if(o){const t=o(e);if("boolean"==typeof t)return t}return Ve.has(L(e))},skipSelf:e=>{if(!De(e)&&!Me(e))return!0;if(i){const t=i(e);if("boolean"==typeof t)return t}return We.has(L(e))}});class ze{constructor(e,t){this.descend=!0,this.nextNode=m.some(e),this.rootNode=e,this.config=t,this.nextNode.each((e=>{this.skipSelf(e)&&this.next()}))}toArray(){const e=[];let t=this.next();for(;!t.done;){const{value:n}=t;e.push(n),t=this.next()}return e}forEach(e){let t=0,n=this.next();for(;!n.done;)e(n.value,t),n=this.next(),t++}reduce(e,t){let n=t,r=this.next();for(;!r.done;)n=e(n,r.value),r=this.next();return n}some(e){let t=this.next();for(;!t.done;){if(e(t.value))return!0;t=this.next()}return!1}next(){return this.nextNode.fold((()=>({done:!0,value:this.rootNode})),(e=>(this.descend&&e.dom.firstChild&&!this.skipChildren(e)?this.nextNode=Q(e):H(e,this.rootNode)?this.nextNode=m.none():Z(e).isSome()?(this.nextNode=Z(e),this.descend=!0):(this.nextNode=G(e),this.descend=!1,this.next()),this.nextNode.each((e=>{this.skipSelf(e)&&this.next()})),{done:!1,value:e})))}skipSelf(e){return!(!this.config||!this.config.skipSelf)&&this.config.skipSelf(e)}skipChildren(e){return!(!this.config||!this.config.skipChildren)&&this.config.skipChildren(e)}}const qe=e=>"th"===e?"td":e,Ge=(e,t)=>new ze(e,t).reduce(((e,t)=>{return e+(De(t)?t.dom.data:(n=qe(L(t)),String.fromCharCode(57344+(e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t})(n)%6400)));var n}),""),Xe=e=>De(e)?e.dom.length:1,Ye=e=>"tr"===L(e),Ze={skipChildren:Ye,skipSelf:e=>!Ye(e)},Je=(e,t,n={})=>{const r=q(t).dom,o=Ke(n),{addedClass:i,diffText:s,modifiedClass:a,removedClass:l,skipSelf:h,skipChildren:f}=o,u=e=>!h(e),_=(e,t)=>S(Te(e,m.from(t)),u).length,d=e=>Me(e)&&h(e),g=(e,t)=>D(S(Te(e,m.from(t)),d)),p=e=>je(K,e)?1:je(W,e)?-1:0,v=s(Ge(e,o),Ge(t,o));let y=0;const b=new ze(e,o),w=new ze(t,o);let k,C,M,A,E,N=0,R=0,T=0;M=v[y++],({done:k,value:A}=b.next()),({done:C,value:E}=w.next());const P=se([],r);let U=P,F=0,j=P,$=0,B=m.none(),V=m.none();const W=new Set,K=new Set,z=new Set,Z=new Map,Q=new Array,re=new Map,oe=()=>{const t=_(A,e);for(;F>t;)G(U).fold((()=>{Ie()}),(e=>{B.each((e=>{H(U,e)&&(B=m.none())})),U=e,F--}));F!==t&&Ie()},ie=()=>{const e=_(E,t);for(;$>e;)G(j).fold((()=>{Ie()}),(e=>{V.each((e=>{H(j,e)&&(V=m.none())})),j=e,$--}));$!==e&&Ie()},ae=n=>{if((!H(U,j)||V.isSome()||B.isSome())&&Ie(),De(n)){const r=g(A,e),o=g(E,t);Z.set(n,o);const i=r.length;if(i!==o.length)z.add(n);else for(let e=0;e<i;++e)if(!Re(r[e],o[e])){z.add(n);break}}else{Re(A,E)||z.add(n);const e=L(A);"table"===e?Q.push({newTable:E,oldTable:A,outputTable:n}):"tr"===e&&re.set(n,{newRow:E,oldRow:A})}te(j,n),U=n,j=n,F++,$++},ce=t=>{if(B.isNone()&&(B=m.from(t),W.add(t)),De(t)){const n=g(A,e);Z.set(t,n)}te(U,t),U=t,F++},he=e=>{if(V.isNone()&&(V=m.from(e),K.add(e)),De(e)){const n=g(E,t);Z.set(e,n)}te(j,e),j=e,$++},fe=e=>{const t=M[1].length;N+=e,N===t?(M=v[y++],N=0):N>t&&Ie()},ue=e=>{const t=Xe(A);R+=e,R===t?(({done:k,value:A}=b.next()),R=0):R>t&&Ie()},_e=e=>{const t=Xe(E);T+=e,T===t?(({done:C,value:E}=w.next()),T=0):T>t&&Ie()};for(;M;)if(M[0]===le){k&&Ie(),oe();const e=Math.min(M[1].length-N,Xe(A)-R),t=M[1].substring(N,N+e);ce(De(A)?O(t,r):pe(A)),fe(e),ue(e)}else if(1===M[0]){C&&Ie(),ie();const e=Math.min(M[1].length-N,Xe(E)-T),t=M[1].substring(N,N+e);he(De(E)?O(t,r):pe(E)),fe(e),_e(e)}else{(k||C)&&Ie(),oe(),ie();const e=Math.min(M[1].length-N,Xe(A)-R,Xe(E)-T),t=M[1].substring(N,N+e),n=()=>De(A)&&De(E),o=()=>qe(L(A))===qe(L(E)),i=()=>!f(A)&&!f(E);H(U,j)&&(n()||o()&&i()||Re(A,E)||Ne(A,E))?ae(De(E)?O(t,r):pe(E)):(ce(De(A)?O(t,r):pe(A)),he(De(E)?O(t,r):pe(E))),fe(e),ue(e),_e(e)}return x(Array.from(W),(e=>{let t=Y(e).getOrNull();for(;c(t)&&je(K,t);)ee(t,e),t=Y(e).getOrNull()})),Q.forEach((e=>{const{newTable:t,oldTable:r,outputTable:o}=e,i=e=>we(e,"td[colspan],th[colspan],td[rowspan],th[rowspan]").length>0;if(!Le(r,!0)||!Le(t,!0)||!Le(o,!1)||(i(t)||i(r))&&!(e=>{for(const t of e.values()){const e=t.oldRow,n=t.newRow;if(!Be(e,n))return!1}return!0})(re)){new ze(o).forEach((e=>{K.delete(e),W.delete(e),z.delete(e),Z.delete(e)}));const e=me(r),n=me(t);return ee(o,e),ee(o,n),ne(o),W.add(e),void K.add(n)}const s=[];new ze(o,Ze).forEach((e=>$e(re,e).map((t=>{const{oldRow:n,newRow:r}=t,o=J(n),i=J(r),a=o.length,l=i.length,c=Math.max(a,l),h=Math.min(a,l),f=[],u=J(e);if(u.length===c){const e=u;for(let t=0,n=e.length;t<n;++t)f.push(p(e[t]));s.push(f)}else{let e=0,t=0;for(;e<h;)f[e++]=t;for(t=a<l?1:-1;e<c;)f[e++]=t;s.push(f)}})))),0===s.length&&Ie(),new ze(o,Ze).forEach(((e,t)=>{const r=J(e);X(e).each((o=>{if(je(K,e)||je(K,o)){if(s[t]&&r.length<s[t].length)for(let e=0;e<s[t].length;++e)if(-1===s[t][e]){const t=I("td");ee(r[e],t),W.add(t)}}else if(je(W,e)||je(W,o)){if(s[t]&&r.length<s[t].length)for(let e=0;e<s[t].length;++e)if(1===s[t][e]){const t=I("td");ee(r[e],t)}}else{let o=!0;for(let e=0,n=r.length;e<n;++e)if(s[t]&&p(r[e])!==s[t][e]){o=!1;break}if(!o){const r=new ze(e);for(r.next(),r.forEach((e=>{K.delete(e),W.delete(e),z.delete(e),Z.delete(e)}));e.dom.firstChild;)e.dom.removeChild(e.dom.firstChild);$e(re,e).each((({newRow:r,oldRow:o})=>{const i=J(r),a=J(o);let l=0,c=0;for(const r of s[t])if(1===r){const t=me(i[c++]);te(e,t),K.add(t)}else if(-1===r){const t=me(a[l++]);te(e,t),W.add(t)}else e.dom.appendChild(Je(a[l++],i[c++],n).dom)}))}}}))}))})),W.forEach((e=>{He(e,"del",l)})),K.forEach((e=>{He(e,"ins",i)})),o.skipModified||z.forEach((e=>{He(e,"ins",a)})),Z.forEach(((e,t)=>{e.forEach((e=>{Y(t).filter((t=>Re(t,e))).fold((()=>{const n=pe(e);ee(t,n),te(n,t)}),(e=>te(e,t)))}))})),P},Qe=(e,t)=>{const n=[`pre ins.${t.addition}`,`pre del.${t.removal}`].join(","),r=we(e,n);x(r,(e=>{((e,t)=>{const n=z(e).dom,r=P(n.createDocumentFragment());((e,t)=>{x(t,(t=>{te(e,t)}))})(r,re(t,n)),(e=>{e.dom.textContent="",x(J(e),(e=>{ne(e)}))})(e),te(e,r)})(e,oe(e).replace(/\n/g,'<span data-mce-newline-placeholder="1">&nbsp;</span>\n'))}))},et=(e,t,n)=>{const r=se(re(e)),o=se(re(t)),i={addedClass:n.addition,removedClass:n.removal,modifiedClass:n.modification};return((e,t)=>(x([Qe],(n=>{n(e,t)})),e))(Je(r,o,i),n)},tt={addition:"tox-revisionhistory__annotation--added",removal:"tox-revisionhistory__annotation--removed",modification:"tox-revisionhistory__annotation--modified"},nt=e=>t=>t.options.get(e),rt=e=>t=>m.from(nt(e)(t)).filter(h),ot=(it="revisionhistory_fetch",e=>rt(it)(e).getOrDie(it+" has not been implemented."));var it;const st=rt("revisionhistory_fetch_revision"),at=nt("revisionhistory_css_url"),lt=e=>{const t=m.from(e.options.get("revisionhistory_diff_classes")).getOr({});return((e,t)=>{const n={};return((e,t)=>{const n=ce(e);for(let r=0,o=n.length;r<o;r++){const o=n[r];t(e[o],o)}})(e,((e,r)=>{const o=t(e,r);n[o.k]=o.v})),n})(tt,((e,n)=>{return{k:n,v:(r=e,o=n,((e,t)=>((e,t)=>he.call(e,t))(e,t)?m.from(e[t]):m.none())(t,o).getOr(r))};var r,o}))},ct=nt("revisionhistory_author"),ht=nt("revisionhistory_display_author"),ft=nt("body_class"),ut=nt("content_style"),_t=nt("content_css_cors"),dt=nt("revisionhistory_allow_restore"),gt=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295;let pt=0;const mt=e=>{const t=(new Date).getTime(),n=Math.floor(1e9*gt());return pt++,e+"_"+n+pt+String(t)},vt=e=>{const t=(e=>{let t=e;return{get:()=>t,set:e=>{t=e}}})(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{n(),t.set(m.some(e))}}},yt=(e,t,n=0,r)=>{const o=e.indexOf(t,n);return-1!==o&&(!!a(r)||o+t.length<=r)},bt=e=>e.length>0,wt=(e,t)=>tinymce.html.Serializer({validate:!0},e.schema).serialize(e.parser.parse(t)),xt=e=>wt(e,e.getContent()),St=(e,t)=>({content:xt(e),createdAt:(new Date).toISOString(),revisionId:mt("tinymce"),internalType:t,author:ct(e)});var kt,Ct,Mt,Dt,At,Et,Nt,Rt,Tt,It,Ot,Pt={},Ut=[],Ft=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ht=Array.isArray;function Lt(e,t){for(var n in t)e[n]=t[n];return e}function jt(e){var t=e.parentNode;t&&t.removeChild(e)}function $t(e,t,n,r,o){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==o?++Mt:o,__i:-1,__u:0};return null==o&&null!=Ct.vnode&&Ct.vnode(i),i}function Bt(e){return e.children}function Vt(e,t){this.props=e,this.context=t}function Wt(e,t){if(null==t)return e.__?Wt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Wt(e):null}function Kt(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return Kt(e)}}function zt(e){(!e.__d&&(e.__d=!0)&&Dt.push(e)&&!qt.__r++||At!==Ct.debounceRendering)&&((At=Ct.debounceRendering)||Et)(qt)}function qt(){var e,t,n,r,o,i,s,a;for(Dt.sort(Nt);e=Dt.shift();)e.__d&&(t=Dt.length,r=void 0,i=(o=(n=e).__v).__e,s=[],a=[],n.__P&&((r=Lt({},o)).__v=o.__v+1,Ct.vnode&&Ct.vnode(r),tn(n.__P,r,o,n.__n,void 0!==n.__P.ownerSVGElement,32&o.__u?[i]:null,s,null==i?Wt(o):i,!!(32&o.__u),a),r.__v=o.__v,r.__.__k[r.__i]=r,nn(s,r,a),r.__e!=i&&Kt(r)),Dt.length>t&&Dt.sort(Nt));qt.__r=0}function Gt(e,t,n,r,o,i,s,a,l,c,h){var f,u,_,d,g,p=r&&r.__k||Ut,m=t.length;for(n.__d=l,Xt(n,t,p),l=n.__d,f=0;f<m;f++)null!=(_=n.__k[f])&&"boolean"!=typeof _&&"function"!=typeof _&&(u=-1===_.__i?Pt:p[_.__i]||Pt,_.__i=f,tn(e,_,u,o,i,s,a,l,c,h),d=_.__e,_.ref&&u.ref!=_.ref&&(u.ref&&on(u.ref,null,_),h.push(_.ref,_.__c||d,_)),null==g&&null!=d&&(g=d),65536&_.__u||u.__k===_.__k?(l&&!l.isConnected&&(l=Wt(u)),l=Yt(_,l,e)):"function"==typeof _.type&&void 0!==_.__d?l=_.__d:d&&(l=d.nextSibling),_.__d=void 0,_.__u&=-196609);n.__d=l,n.__e=g}function Xt(e,t,n){var r,o,i,s,a,l=t.length,c=n.length,h=c,f=0;for(e.__k=[],r=0;r<l;r++)s=r+f,null!=(o=e.__k[r]=null==(o=t[r])||"boolean"==typeof o||"function"==typeof o?null:"string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?$t(null,o,null,null,null):Ht(o)?$t(Bt,{children:o},null,null,null):void 0===o.constructor&&o.__b>0?$t(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o)?(o.__=e,o.__b=e.__b+1,a=Zt(o,n,s,h),o.__i=a,i=null,-1!==a&&(h--,(i=n[a])&&(i.__u|=131072)),null==i||null===i.__v?(-1==a&&f--,"function"!=typeof o.type&&(o.__u|=65536)):a!==s&&(a===s+1?f++:a>s?h>l-s?f+=a-s:f--:a<s?a==s-1&&(f=a-s):f=0,a!==r+f&&(o.__u|=65536))):(i=n[s])&&null==i.key&&i.__e&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=Wt(i)),sn(i,i,!1),n[s]=null,h--);if(h)for(r=0;r<c;r++)null!=(i=n[r])&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=Wt(i)),sn(i,i))}function Yt(e,t,n){var r,o;if("function"==typeof e.type){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=Yt(r[o],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function Zt(e,t,n,r){var o=e.key,i=e.type,s=n-1,a=n+1,l=t[n];if(null===l||l&&o==l.key&&i===l.type&&!(131072&l.__u))return n;if(r>(null==l||131072&l.__u?0:1))for(;s>=0||a<t.length;){if(s>=0){if((l=t[s])&&!(131072&l.__u)&&o==l.key&&i===l.type)return s;s--}if(a<t.length){if((l=t[a])&&!(131072&l.__u)&&o==l.key&&i===l.type)return a;a++}}return-1}function Jt(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||Ft.test(t)?n:n+"px"}function Qt(e,t,n,r,o){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Jt(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Jt(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r?n.u=r.u:(n.u=Rt,e.addEventListener(t,i?It:Tt,i)):e.removeEventListener(t,i?It:Tt,i);else{if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function en(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=Rt++;else if(t.t<n.u)return;return n(Ct.event?Ct.event(t):t)}}}function tn(e,t,n,r,o,i,s,a,l,c){var h,f,u,_,d,g,p,m,v,y,b,w,x,S,k,C=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),i=[a=t.__e=n.__e]),(h=Ct.__b)&&h(t);e:if("function"==typeof C)try{if(m=t.props,v=(h=C.contextType)&&r[h.__c],y=h?v?v.props.value:h.__:r,n.__c?p=(f=t.__c=n.__c).__=f.__E:("prototype"in C&&C.prototype.render?t.__c=f=new C(m,y):(t.__c=f=new Vt(m,y),f.constructor=C,f.render=an),v&&v.sub(f),f.props=m,f.state||(f.state={}),f.context=y,f.__n=r,u=f.__d=!0,f.__h=[],f._sb=[]),null==f.__s&&(f.__s=f.state),null!=C.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=Lt({},f.__s)),Lt(f.__s,C.getDerivedStateFromProps(m,f.__s))),_=f.props,d=f.state,f.__v=t,u)null==C.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==C.getDerivedStateFromProps&&m!==_&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(m,y),!f.__e&&(null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(m,f.__s,y)||t.__v===n.__v)){for(t.__v!==n.__v&&(f.props=m,f.state=f.__s,f.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),b=0;b<f._sb.length;b++)f.__h.push(f._sb[b]);f._sb=[],f.__h.length&&s.push(f);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(m,f.__s,y),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(_,d,g)}))}if(f.context=y,f.props=m,f.__P=e,f.__e=!1,w=Ct.__r,x=0,"prototype"in C&&C.prototype.render){for(f.state=f.__s,f.__d=!1,w&&w(t),h=f.render(f.props,f.state,f.context),S=0;S<f._sb.length;S++)f.__h.push(f._sb[S]);f._sb=[]}else do{f.__d=!1,w&&w(t),h=f.render(f.props,f.state,f.context),f.state=f.__s}while(f.__d&&++x<25);f.state=f.__s,null!=f.getChildContext&&(r=Lt(Lt({},r),f.getChildContext())),u||null==f.getSnapshotBeforeUpdate||(g=f.getSnapshotBeforeUpdate(_,d)),Gt(e,Ht(k=null!=h&&h.type===Bt&&null==h.key?h.props.children:h)?k:[k],t,n,r,o,i,s,a,l,c),f.base=t.__e,t.__u&=-161,f.__h.length&&s.push(f),p&&(f.__E=f.__=null)}catch(e){t.__v=null,l||null!=i?(t.__e=a,t.__u|=l?160:32,i[i.indexOf(a)]=null):(t.__e=n.__e,t.__k=n.__k),Ct.__e(e,t,n)}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=rn(n.__e,t,n,r,o,i,s,l,c);(h=Ct.diffed)&&h(t)}function nn(e,t,n){t.__d=void 0;for(var r=0;r<n.length;r++)on(n[r],n[++r],n[++r]);Ct.__c&&Ct.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Ct.__e(e,t.__v)}}))}function rn(e,t,n,r,o,i,s,a,l){var c,h,f,u,_,d,g,p=n.props,m=t.props,v=t.type;if("svg"===v&&(o=!0),null!=i)for(c=0;c<i.length;c++)if((_=i[c])&&"setAttribute"in _==!!v&&(v?_.localName===v:3===_.nodeType)){e=_,i[c]=null;break}if(null==e){if(null===v)return document.createTextNode(m);e=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,m.is&&m),i=null,a=!1}if(null===v)p===m||a&&e.data===m||(e.data=m);else{if(i=i&&kt.call(e.childNodes),p=n.props||Pt,!a&&null!=i)for(p={},c=0;c<e.attributes.length;c++)p[(_=e.attributes[c]).name]=_.value;for(c in p)_=p[c],"children"==c||("dangerouslySetInnerHTML"==c?f=_:"key"===c||c in m||Qt(e,c,null,_,o));for(c in m)_=m[c],"children"==c?u=_:"dangerouslySetInnerHTML"==c?h=_:"value"==c?d=_:"checked"==c?g=_:"key"===c||a&&"function"!=typeof _||p[c]===_||Qt(e,c,_,p[c],o);if(h)a||f&&(h.__html===f.__html||h.__html===e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(f&&(e.innerHTML=""),Gt(e,Ht(u)?u:[u],t,n,r,o&&"foreignObject"!==v,i,s,i?i[0]:n.__k&&Wt(n,0),a,l),null!=i)for(c=i.length;c--;)null!=i[c]&&jt(i[c]);a||(c="value",void 0!==d&&(d!==e[c]||"progress"===v&&!d||"option"===v&&d!==p[c])&&Qt(e,c,d,p[c],!1),c="checked",void 0!==g&&g!==e[c]&&Qt(e,c,g,p[c],!1))}return e}function on(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Ct.__e(e,n)}}function sn(e,t,n){var r,o;if(Ct.unmount&&Ct.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||on(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Ct.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&sn(r[o],t,n||"function"!=typeof e.type);n||null==e.__e||jt(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function an(e,t,n){return this.constructor(e,n)}function ln(e,t,n){var r,o,i;Ct.__&&Ct.__(e,t),r=t.__k,o=[],i=[],tn(t,e=t.__k=function(e,t,n){var r,o,i,s={};for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:s[i]=t[i];if(arguments.length>2&&(s.children=arguments.length>3?kt.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===s[i]&&(s[i]=e.defaultProps[i]);return $t(e,s,r,o,null)}(Bt,null,[e]),r||Pt,Pt,void 0!==t.ownerSVGElement,r?null:t.firstChild?kt.call(t.childNodes):null,o,r?r.__e:t.firstChild,!1,i),nn(o,e,i)}kt=Ut.slice,Ct={__e:function(e,t,n,r){for(var o,i,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(e)),s=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,r||{}),s=o.__d),s)return o.__E=o}catch(t){e=t}throw e}},Mt=0,Vt.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Lt({},this.state),"function"==typeof e&&(e=e(Lt({},n),this.props)),e&&Lt(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),zt(this))},Vt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),zt(this))},Vt.prototype.render=Bt,Dt=[],Et="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Nt=function(e,t){return e.__v.__b-t.__v.__b},qt.__r=0,Rt=0,Tt=en(!1),It=en(!0),Ot=0;var cn=0;function hn(e,t,n,r,o,i){var s,a,l={};for(a in t)"ref"==a?s=t[a]:l[a]=t[a];var c={type:e,props:l,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--cn,__i:-1,__u:0,__source:o,__self:i};if("function"==typeof e&&(s=e.defaultProps))for(a in s)void 0===l[a]&&(l[a]=s[a]);return Ct.vnode&&Ct.vnode(c),c}const fn=(e,t)=>{x(t,(t=>{((e,t)=>{ke(e)?e.dom.classList.remove(t):((e,t)=>{((e,t,n)=>{const r=S(Se(e,t),(e=>e!==n));r.length>0?fe(e,t,r.join(" ")):de(e,t)})(e,"class",t)})(e,t),(e=>{const t=ke(e)?e.dom.classList:(e=>Se(e,"class"))(e);0===t.length&&de(e,"class")})(e)})(e,t)}))};var un,_n,dn,gn,pn=0,mn=[],vn=[],yn=Ct,bn=yn.__b,wn=yn.__r,xn=yn.diffed,Sn=yn.__c,kn=yn.unmount,Cn=yn.__;function Mn(e,t){yn.__h&&yn.__h(_n,e,pn||t),pn=0;var n=_n.__H||(_n.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:vn}),n.__[e]}function Dn(e){return pn=1,function(e,t){var n=Mn(un++,2);if(n.t=e,!n.__c&&(n.__=[Hn(void 0,t),function(e){var t=n.__N?n.__N[0]:n.__[0],r=n.t(t,e);t!==r&&(n.__N=[r,n.__[1]],n.__c.setState({}))}],n.__c=_n,!_n.u)){var r=function(e,t,r){if(!n.__c.__H)return!0;var i=n.__c.__H.__.filter((function(e){return!!e.__c}));if(i.every((function(e){return!e.__N})))return!o||o.call(this,e,t,r);var s=!1;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}})),!(!s&&n.__c.props===e)&&(!o||o.call(this,e,t,r))};_n.u=!0;var o=_n.shouldComponentUpdate,i=_n.componentWillUpdate;_n.componentWillUpdate=function(e,t,n){if(this.__e){var s=o;o=void 0,r(e,t,n),o=s}i&&i.call(this,e,t,n)},_n.shouldComponentUpdate=r}return n.__N||n.__}(Hn,e)}function An(e,t){var n=Mn(un++,3);!yn.__s&&Fn(n.__H,t)&&(n.__=e,n.i=t,_n.__H.__h.push(n))}function En(e){return pn=5,Nn((function(){return{current:e}}),[])}function Nn(e,t){var n=Mn(un++,7);return Fn(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Rn(e){var t=_n.context[e.__c],n=Mn(un++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(_n)),t.props.value):e.__}function Tn(){for(var e;e=mn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Pn),e.__H.__h.forEach(Un),e.__H.__h=[]}catch(t){e.__H.__h=[],yn.__e(t,e.__v)}}yn.__b=function(e){_n=null,bn&&bn(e)},yn.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Cn&&Cn(e,t)},yn.__r=function(e){wn&&wn(e),un=0;var t=(_n=e.__c).__H;t&&(dn===_n?(t.__h=[],_n.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=vn,e.__N=e.i=void 0}))):(t.__h.forEach(Pn),t.__h.forEach(Un),t.__h=[],un=0)),dn=_n},yn.diffed=function(e){xn&&xn(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==mn.push(t)&&gn===yn.requestAnimationFrame||((gn=yn.requestAnimationFrame)||On)(Tn)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==vn&&(e.__=e.__V),e.i=void 0,e.__V=vn}))),dn=_n=null},yn.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Pn),e.__h=e.__h.filter((function(e){return!e.__||Un(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],yn.__e(n,e.__v)}})),Sn&&Sn(e,t)},yn.unmount=function(e){kn&&kn(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Pn(e)}catch(e){t=e}})),n.__H=void 0,t&&yn.__e(t,n.__v))};var In="function"==typeof requestAnimationFrame;function On(e){var t,n=function(){clearTimeout(r),In&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);In&&(t=requestAnimationFrame(n))}function Pn(e){var t=_n,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),_n=t}function Un(e){var t=_n;e.__c=e.__(),_n=t}function Fn(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function Hn(e,t){return"function"==typeof t?t(e):t}const Ln=e=>{const t=new Date(e),n=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),r=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${n.replace(",","")}, ${r}`},jn=()=>$n(0,0),$n=(e,t)=>({major:e,minor:t}),Bn={nu:$n,detect:(e,t)=>{const n=String(t).toLowerCase();return 0===e.length?jn():((e,t)=>{const n=((e,t)=>{for(let n=0;n<e.length;n++){const r=e[n];if(r.test(t))return r}})(e,t);if(!n)return{major:0,minor:0};const r=e=>Number(t.replace(n,"$"+e));return $n(r(1),r(2))})(e,n)},unknown:jn},Vn=(e,t)=>{const n=String(t).toLowerCase();return C(e,(e=>e.search(n)))},Wn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Kn=e=>t=>yt(t,e),zn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>yt(e,"edge/")&&yt(e,"chrome")&&yt(e,"safari")&&yt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Wn],search:e=>yt(e,"chrome")&&!yt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>yt(e,"msie")||yt(e,"trident")},{name:"Opera",versionRegexes:[Wn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Kn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Kn("firefox")},{name:"Safari",versionRegexes:[Wn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(yt(e,"safari")||yt(e,"mobile/"))&&yt(e,"applewebkit")}],qn=[{name:"Windows",search:Kn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>yt(e,"iphone")||yt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Kn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Kn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Kn("linux"),versionRegexes:[]},{name:"Solaris",search:Kn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Kn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Kn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Gn={browsers:_(zn),oses:_(qn)},Xn=e=>{const t=e.current,n=e.version,r=e=>()=>t===e;return{current:t,version:n,isEdge:r("Edge"),isChromium:r("Chromium"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},Yn=()=>Xn({current:void 0,version:Bn.unknown()}),Zn=Xn,Jn=e=>{const t=e.current,n=e.version,r=e=>()=>t===e;return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isMacOS:r("macOS"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},Qn=()=>Jn({current:void 0,version:Bn.unknown()}),er=Jn,tr=(e,t,n)=>{const r=Gn.browsers(),o=Gn.oses(),i=t.bind((e=>((e,t)=>((e,t)=>{for(let n=0;n<e.length;n++){const r=t(e[n]);if(r.isSome())return r}return m.none()})(t.brands,(t=>{const n=t.brand.toLowerCase();return C(e,(e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:Bn.nu(parseInt(t.version,10),0)})))})))(r,e))).orThunk((()=>((e,t)=>Vn(e,t).map((e=>{const n=Bn.detect(e.versionRegexes,t);return{current:e.name,version:n}})))(r,e))).fold(Yn,Zn),s=((e,t)=>Vn(e,t).map((e=>{const n=Bn.detect(e.versionRegexes,t);return{current:e.name,version:n}})))(o,e).fold(Qn,er),a=((e,t,n,r)=>{const o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,s=e.isiOS()||e.isAndroid(),a=s||r("(pointer:coarse)"),l=o||!i&&s&&r("(min-device-width:768px)"),c=i||s&&!l,h=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!c&&!l&&!h;return{isiPad:_(o),isiPhone:_(i),isTablet:_(l),isPhone:_(c),isTouch:_(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:_(h),isDesktop:_(f)}})(s,i,e,n);return{browser:i,os:s,deviceType:a}},nr=e=>window.matchMedia(e).matches;let rr=(e=>{let t,n=!1;return(...r)=>(n||(n=!0,t=e.apply(null,r)),t)})((()=>tr(window.navigator.userAgent,m.from(window.navigator.userAgentData),nr)));const or=()=>rr(),ir=e=>c(e.content)?e.content:"",sr=["#2DC26B","#F1C40F","#E03E2D","#B96AD9","#3598DB","#169179","#E67E23","#BA372A","#843FA1","#236FA1","#95A5A6","#7E8C8D","#34495E"],ar=()=>{const e=Math.floor(gt()*sr.length);return sr[e]},lr=(e,t,n=36)=>{const r=n/2;return`<svg height="${n}" width="${n}" xmlns="http://www.w3.org/2000/svg"><circle cx="${r}" cy="${r}" r="${r}" fill="${t}"/><text x="50%" y="50%" text-anchor="middle" dominant-baseline="central" fill="#FFF" font-family="sans-serif" font-size="${r}">`+(e=>{var t;let n;return Intl.Segmenter&&(n=null===(t=(new Intl.Segmenter).segment(e)[Symbol.iterator]().next().value)||void 0===t?void 0:t.segment),c(n)?n:(()=>{let t=0;for(;e.charCodeAt(t)>255&&t<e.length;)t++;return t>0?e.slice(0,t):e[0]})()})(e)+"</text></svg>"},cr=({children:e,politenessSetting:t="polite",className:n})=>hn("div",{style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px"},"aria-live":t,className:n,children:e});var hr=function(e,t){var n={__c:t="__cC"+Ot++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some((function(e){e.__e=!0,zt(e)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}(m.none());const fr=(e,t,n)=>((e,t,n)=>{let r=e.dom;const o=h(n)?n:g;for(;r.parentNode;){r=r.parentNode;const e=P(r);if(t(e))return m.some(e);if(o(e))break}return m.none()})(e,(e=>U(e,t)),n),ur=(e,t,n)=>((e,t,n,r,o)=>e(n,r)?m.some(n):h(o)&&o(n)?m.none():t(n,r,o))(((e,t)=>U(e,t)),fr,e,t,n),_r=e=>void 0!==e.style&&h(e.style.getPropertyValue),dr=(e,t)=>{const n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||be(e)?r:gr(n,t)},gr=(e,t)=>_r(e)?e.style.getPropertyValue(t):"",pr=(e,t)=>n=>"rtl"===mr(n)?t:e,mr=e=>"rtl"===dr(e,"direction")?"rtl":"ltr",vr=e=>(t,n,r)=>{const o=e(t);return wr(o,t,n,r)},yr=(e,t)=>{const n=pr(e,t);return vr(n)},br=(e,t)=>{const n=pr(t,e);return vr(n)},wr=(e,t,n,r)=>r.focusManager.get(t).bind((n=>e(t,n,r))).map((e=>(r.focusManager.set(t,e),!0))),xr=e=>!(e=>e.offsetWidth<=0&&e.offsetHeight<=0)(e.dom),Sr=(e,t,n)=>{const r=we(e,n);return(e=>M(e,(e=>H(e,t))).map((t=>({index:t,candidates:e}))))(S(r,xr))},kr=(e,t,n,r,o)=>{const i=(e,t,n)=>o(e,t,r,0,n.length-1,n[t],(t=>{return r=n[t],"button"===L(r)&&"disabled"===ue(r,"disabled")?i(e,t,n):m.from(n[t]);var r}));return Sr(e,n,t).bind((e=>{const t=e.index,n=e.candidates;return i(t,t,n)}))},Cr=(e,t,n,r)=>kr(e,t,n,r,((e,t,n,r,o,i,s)=>{const a=((e,t,n)=>Math.min(Math.max(e,t),n))(t+n,r,o);return a===e?m.from(i):s(a)})),Mr=(e,t,n,r)=>kr(e,t,n,r,((e,t,n,r,o,i,s)=>{const a=((e,t,n,r)=>{const o=e+t;return o>r?n:o<n?r:o})(t,n,r,o);return a===e?m.none():s(a)})),Dr=()=>({get:e=>{return((e=(()=>P(document))())=>m.from(e.dom.activeElement).map(P))(ve(t=e)).filter((e=>t.dom.contains(e.dom)));var t},set:(e,t)=>{t.dom.focus(),t.dom.dispatchEvent(new window.Event("Focus"))}});var Ar;!function(e){e.OnFocusMode="onFocus"}(Ar||(Ar={}));const Er=(e,t)=>({matches:e,classification:t}),Nr=(e,t,n,r)=>{const o={...e,focusManager:Dr(),focusInside:Ar.OnFocusMode,focusIn:r},i=(e,t,n)=>((e,t)=>{const n=C(e,(e=>e.matches(t)));return n.map((e=>e.classification))})(n(e,t,o),t).bind((n=>n(e,t,o)));return{handleKeydown:(e,n)=>i(e,n,t).each((e=>{n.preventDefault(),n.stopPropagation()})),handleKeyup:(e,t)=>i(e,t,n).each((()=>{t.preventDefault(),t.stopPropagation()})),handleFocus:(e,t)=>{r(o).each((n=>{n(e,o),t.preventDefault(),t.stopPropagation()}))}}},Rr=e=>t=>b(e,t.which),Tr=[9],Ir=[13],Or=[37],Pr=[38],Ur=[39],Fr=[40],Hr=[32],Lr=(e,t)=>{const n=(e,t,n)=>((e,t)=>t.focusManager.get(e).bind((e=>ur(e,t.selector))))(e,n).bind((e=>n.execute(e))),r=(e,t)=>{((e,t)=>((e,t)=>{const n=void 0===t?document:t.dom;return F(n)?m.none():m.from(n.querySelector(e)).map(P)})(t,e))(e,t.selector).each((n=>{t.focusManager.set(e,n)}))},o=(e,t,n)=>(n.cycles?Mr:Cr)(e,n.selector,t,-1),i=(e,t,n)=>(n.cycles?Mr:Cr)(e,n.selector,t,1),s=e=>(t,n,r)=>e(t,n,r),a=_([]),l=Nr({selector:t,execute:e=>(e.dom.dispatchEvent(new window.Event("click")),m.some(!0)),allowVertical:!0,allowHorizontal:!0,cycles:!0},((e,t,r)=>{const a=[...r.allowHorizontal?Or:[]].concat(r.allowVertical?Pr:[]),l=[...r.allowHorizontal?Ur:[]].concat(r.allowVertical?Fr:[]);return[Er(Rr(a),s(yr(o,i))),Er(Rr(l),s(br(o,i))),Er(Rr(Ir),n),Er(Rr(Hr),n)]}),a,(()=>m.some(r)));return{keydown:t=>l.handleKeydown(e,t),keyup:t=>l.handleKeyup(e,t),focus:t=>l.handleFocus(e,t)}},jr=(e=>{const t=t=>{const n=(e=>{const t=e.dom;return be(e)?t.getBoundingClientRect().height:t.offsetHeight})(t);if(n<=0||null===n){const n=dr(t,e);return parseFloat(n)||0}return n},n=(e,t)=>k(t,((t,n)=>{const r=dr(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0);return{set:(t,n)=>{if(!f(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const r=t.dom;_r(r)&&(r.style[e]=n+"px")},get:t,getOuter:t,aggregate:n,max:(e,t,r)=>{const o=n(e,r);return t>o?t-o:0}}})("height"),$r=(e,t,n)=>{const r=D(e.slice(0,t)),o=D(e.slice(t+1));return C(r.concat(o),n)},Br=(e,t,n)=>{const r=D(e.slice(0,t));return C(r,n)},Vr=(e,t,n)=>{const r=e.slice(0,t),o=e.slice(t+1);return C(o.concat(r),n)},Wr=(e,t,n)=>{const r=e.slice(t+1);return C(r,n)},Kr=(e,t)=>t.focusManager.get(e).bind((e=>ur(e,t.selector))),zr=(e,t)=>{((e,t)=>{const n=we(e,t.selector),r=S(n,(e=>(e=>jr.get(e))(e)>0));return m.from(r[t.firstTabstop])})(e,t).each((n=>t.focusManager.set(e,n)))},qr=(e,t,n,r)=>{const o=we(e,n.selector);return Kr(e,n).bind((t=>M(o,function(e,...t){return(...n)=>{const r=t.concat(n);return e.apply(null,r)}}(H,t)).bind((t=>((e,t,n,r,o)=>o(t,n,(e=>((e,t)=>e.useTabstopAt(t))(r,e))).fold((()=>r.cyclic?m.some(!0):m.none()),(t=>(r.focusManager.set(e,t),m.some(!0)))))(e,o,t,n,r)))))},Gr=(e,t,n)=>{const r=n.cyclic?$r:Br;return qr(e,0,n,r)},Xr=(e,t,n)=>{const r=n.cyclic?Vr:Wr;return qr(e,0,n,r)},Yr=_([Er((Zr=[e=>!0===e.shiftKey,Rr(Tr)],e=>((e,t)=>{for(let n=0,r=e.length;n<r;++n)if(!0!==t(e[n]))return!1;return!0})(Zr,(t=>t(e)))),Gr),Er(Rr(Tr),Xr)]);var Zr;const Jr=_([Er(Rr(Tr),((e,t,n)=>Kr(e,n).filter((e=>!n.useTabstopAt(e))).bind((r=>((e=>X(e).bind(Q).exists((t=>H(t,e))))(r)?Gr:Xr)(e,t,n)))))]),Qr=(e,t)=>{const n=Nr({selector:t,firstTabstop:0,useTabstopAt:p,cyclic:!0},Yr,Jr,(()=>m.some(zr)));return{keydown:t=>n.handleKeydown(e,t),keyup:t=>n.handleKeyup(e,t),focus:t=>n.handleFocus(e,t)}},eo=(e,t,n)=>Nn((()=>{if(e.current){const r=("tab"===n?Qr:Lr)(P(e.current),t);return{onKeyUp:r.keyup,onKeyDown:r.keydown,onFocus:r.focus}}return{onKeyDown:u,onKeyUp:u,onFocus:u}}),[e.current]),to=({items:e})=>{const t=En(null);return hn("div",{ref:t,className:"tox-view__toolbar",tabIndex:-1,...eo(t,".tox-button:not([disabled])","flow"),children:w(e,((e,t)=>"title"===e.type?hn("div",{className:"tox-view__label tox-view__label--large",tabindex:-1,children:e.label},t):e.hide?null:hn("button",{className:"tox-button "+(!0===e.primary?"tox-button--primary tox-revisionhistory--align-right":"tox-button--secondary"),onClick:e.onAction,type:"button",disabled:e.disabled,children:e.label},t)))})},no=({avatar:e,name:t})=>{const n=Nn((()=>m.from(e).filter(bt).getOrThunk((()=>`data:image/svg+xml, ${encodeURIComponent(lr(t,ar()))}`))),[e,t]),[r,o]=Dn(n);return An((()=>{o(n)}),[n]),hn("img",{className:"tox-revisionhistory__avatar",src:r,onError:()=>{o(`data:image/svg+xml, ${encodeURIComponent(lr(t,ar()))}`)}})},ro=e=>hn("div",{className:"tox-revisionhistory__card-author",children:[hn(no,{...e}),hn("span",{className:"tox-revisionhistory__card-author-name","aria-label":e.name,children:e.name})]}),oo=()=>{const e=Rn(hr);return hn("img",{className:"tox-revisionhistory__card-check-icon",src:Nn((()=>e.map((e=>{return t=e.editor,m.from(t.ui.registry.getAll().icons.checkmark).fold(_(""),(e=>{let t=e;return yt(e,"xmlns")||(t=e.replace("svg",'svg xmlns="http://www.w3.org/2000/svg"')),`data:image/svg+xml, ${encodeURIComponent(t)}`}));var t})).getOr("")),[e])})},io=({revision:e,isSelected:t,onSelect:n,showAuthor:r})=>{const o=Ln(e.createdAt),i=tinymce.i18n.translate(["Revision on {0}",o]),s=Nn((()=>{const t=m.from(e.author).getOr({id:"anonymous"});return{...t,name:c(t.name)&&bt(t.name)?t.name:tinymce.i18n.translate("Anonymous")}}),[e]);return hn("div",{role:"listitem",children:hn("div",{"aria-pressed":t,className:"tox-revisionhistory__card "+(t?"tox-revisionhistory__card--selected":""),tabIndex:-1,onClick:n,"aria-label":i,role:"button",children:[hn("div",{children:[e.internalType&&hn("span",{className:"tox-label tox-revisionhistory__card-label",children:tinymce.i18n.translate(e.internalType.toUpperCase())}),hn("div",{className:"tox-revisionhistory__card-date",children:[hn("span",{className:"tox-revisionhistory__card-date-label",children:o}),t&&hn(oo,{})]})]}),r&&hn(ro,{...s})]})})},so=({revisions:e,onRevisionSelected:t})=>{const[n,r]=Dn(""),o=[".tox-revisionhistory__card",".tox-revisionhistory__norevision"].join(", "),i=En(null),s=eo(i,o,"flow"),a=tinymce.i18n.translate("No revisions"),l=tinymce.i18n.translate("Revision History"),h=Rn(hr).map((e=>ht(e.editor))).getOr(!1),f=e=>{r(e),t(e)};return An((()=>{c(e)&&!n&&E(e,0).each((e=>f(e.revisionId)))}),[e]),hn("div",{className:"tox-revisionhistory__sidebar",tabIndex:-1,children:[hn("h1",{className:"tox-revisionhistory__sidebar-title",children:l}),hn("div",{role:"list",ref:i,className:"tox-revisionhistory__revisions",tabIndex:-1,...s,children:c(e)?0===e.length?hn("div",{role:"listitem",className:"tox-revisionhistory__norevision",children:a}):w(e,((e,t)=>hn(io,{showAuthor:h,isSelected:e.revisionId===n,revision:e,onSelect:()=>f(e.revisionId)},t))):null})]})},ao=({restore:e,goBack:t,getRevisions:n,getRevision:r,editor:o})=>{const i=En(null),s=[".tox-view__toolbar",".tox-revisionhistory__revisions"].join(", "),[a,h]=Dn(m.none()),f=eo(i,s,"tab"),[u,d]=Dn(""),[g,p]=Dn(""),[v,y]=Dn(!1),b=tinymce.i18n.translate("Restore this version"),S=tinymce.i18n.translate("Revision History"),C=tinymce.i18n.translate("Close"),D=a.fold(_(S),(({createdAt:e})=>Ln(e))),[A,E]=Dn(),N=async e=>{if(c(A)){o.setProgressState(!0);const t=await(async(e,t,n)=>{const r=[];return M(t,(t=>t.revisionId===e)).each((e=>{r.push(t[e]),e<=t.length-2&&r.push(t[e+1])})),await Promise.all(w(r,n))})(e,A,r);if(o.removed||o.setProgressState(!1),t.length>0&&!o.removed){let e="";const[n,r]=t,i=ir(n);e=c(r)?ie(et(ir(r),i,lt(o))):i,(e=>{if(A&&e.length>0){const t=((e,t)=>{const n=[...e];return x(t,(e=>{e&&M(n,(t=>((e,t)=>e.revisionId===t.revisionId)(e,t))).each((t=>{n[t]=e}))})),n})(A,e);E(t)}})(t),h(m.some(n)),d(((e,t)=>{const n=at(t),r=((e,t)=>{return o=t,n=e.parser.parse(o,{insert:!0}),r=e.schema,tinymce.html.Serializer({validate:!0},r).serialize(n);var n,r,o})(t,e),o=m.from(ut(t)).map((e=>`<style type="text/css">${e}</style>`)).getOr(""),i=xe(_t(t),' crossorigin="anonymous"').getOr(""),s=`<link type="text/css" rel="stylesheet" href="${n}"/>`,a=k(t.contentCSS,((e,n)=>`${e}<link type="text/css" rel="stylesheet" href="${t.documentBaseURI.toAbsolute(n)}"${i}>`),""),l=t.dom.encode,c=m.from(ft(t)).map((e=>` class="${l(e)}"`)).getOr(""),h=m.from(t.getBody()).map((e=>l(e.dir))).bind((e=>xe(""!==e,` dir="${e}"`))).getOr("");return`<!DOCTYPE html><html><head><base href="${l(t.documentBaseURI.getURI())}">`+a+o+"<style>table, table td, table th, table caption { border: 1px dashed #bbb }</style>"+s+(()=>{const e=or().os.isMacOS()||or().os.isiOS();return`<script>(${(e=>{document.addEventListener("click",(t=>{for(let n=t.target;n;n=n.parentNode)if("A"===n.nodeName){const r=n.getAttribute("href");if(r&&r.startsWith("#")){t.preventDefault();const e=document.getElementById(r.substring(1));return void(e&&e.scrollIntoView({behavior:"smooth"}))}(e?t.metaKey:t.ctrlKey&&!t.altKey)||t.preventDefault()}}),!1)}).toString()})(${e})<\/script>`})()+"</head>"+`<body${c}${h}>`+r+"</body></html>"})(e,o));const s=l(r)?tinymce.i18n.translate(["Showing the initial version on {0}",Ln(n.createdAt)]):tinymce.i18n.translate(["Comparing revision on {0} to the previous version",Ln(n.createdAt)]);p(s)}}},R=a.forall((e=>"draft"===e.internalType||"initial"===e.internalType));return An((()=>{(async()=>{o.setProgressState(!0);const e=await n().finally((()=>o.setProgressState(!1)));E(e)})()}),[]),An((()=>{!v&&c(i.current)&&c(A)&&(A.length>0&&a.isSome()||0===A.length)&&(i.current.dispatchEvent(new window.Event("focus")),y(!0))}),[i.current,a,A]),hn("div",{ref:i,...f,className:"tox-revisionhistory__container",children:hn(hr.Provider,{value:m.some({editor:o}),children:[hn(to,{items:[{type:"title",label:D},{type:"button",label:b,disabled:R,hide:!dt(o),primary:!0,onAction:()=>a.each((({content:t,revisionId:n})=>{e(t),((e,t)=>{e.dispatch("VersionRestored",{revisionId:t})})(o,n)}))},{type:"button",label:C,onAction:t}]}),hn("div",{className:"tox-revisionhistory",children:[hn("iframe",{className:"tox-revisionhistory__iframe",srcDoc:u}),hn(so,{onRevisionSelected:e=>{N(e)},revisions:A})]}),hn(cr,{children:g})]})})},lo=(e,t)=>{const n=vt((e=>e.destroy()));e.ui.registry.addView("revision",{onShow:r=>{const o=()=>{return e=r.getContainer(),fn(P(e),["tox-revisionhistory__pane"]),void ln(null,e);var e};var i,s,a;e.on("remove",o),n.set({destroy:()=>{o(),e.off("remove",o)}}),i=r.getContainer(),s={restore:t=>{c(t)&&e.setContent(t),e.execCommand("ToggleView",!1,"revision")},goBack:()=>{e.execCommand("ToggleView",!1,"revision")},...t,editor:e},a=P(i),x(["tox-revisionhistory__pane"],(e=>{Ce(a,e)})),ln(hn(ao,{...s}),i)},onHide:()=>{e.mode.set("design"),n.clear()}})};tinymce.PluginManager.requireLangPack("revisionhistory","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hi,hr,hu_HU,id,it,ja,kk,ko_KR,ms,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,vi,zh_CN,zh_TW"),tinymce.PluginManager.add("revisionhistory",((e,n)=>{if(!((e,n)=>!!e&&-1===((e,n)=>{const r=t(e.major,n.major);if(0!==r)return r;const o=t(e.minor,n.minor);if(0!==o)return o;const i=t(e.patch,n.patch);return 0!==i?i:0})((e=>r((e=>[e.majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."))(e)))(e),r(n)))(tinymce,"7.0.0"))return((e,t)=>{((e,t)=>{const n=e.options.register;n("revisionhistory_fetch",{processor:"function"}),n("revisionhistory_fetch_revision",{processor:"function"}),n("revisionhistory_css_url",{processor:"string",default:t+"/css/revisionhistory.css"}),n("revisionhistory_diff_classes",{processor:"object"}),n("revisionhistory_author",{processor:"object",default:{name:"Anonymous"}}),n("revisionhistory_display_author",{processor:"boolean"}),n("revisionhistory_allow_restore",{processor:"boolean",default:!0})})(e,t);const{getRevision:n,getRevisions:r}=(e=>{const t=(()=>{const e=vt(u);return{...e,on:t=>e.get().each(t)}})(),n=ot(e);return e.on("LoadContent",(()=>{t.set(St(e,"initial"))})),{getRevisions:async()=>{const r=[],o=(e,t=!0)=>{const n=t?R:N;c(e.content)&&bt(e.content)&&n(r).forall((t=>t.content!==e.content))&&(t?r.push(e):r.unshift(e))},i=St(e,"draft");try{const s=await n();0===s.length?(o(i),t.get().each(o)):(x(s,(t=>{r.push({...t,...c(t.content)?{content:wt(e,t.content)}:{}})})),o(i,!1))}catch(t){e.notificationManager.open({text:"An error occurred fetching revisions.",type:"error"}),console.error(t)}return r},getRevision:async t=>new Promise((n=>st(e).fold((()=>{n(t)}),(r=>{l(t.content)?r(e,t).then((t=>{const r=c(t.content)&&bt(t.content)?wt(e,t.content):t.content,o={...t,content:r};n(o)})).catch((r=>{e.removed||(e.notificationManager.open({text:"An error occurred fetching the updated revision.",type:"error"}),console.error(r)),n(t)})):n(t)}))))}})(e);(e=>{e.addCommand("revisionHistory",(()=>{e.inline||("revision"===e.mode.get()?e.mode.set("design"):(e.mode.set("revision"),(e=>{e.dispatch("RevisionHistoryOpen")})(e)))}))})(e),(e=>{const t="revision-history",n="Revision history",r=()=>e.execCommand("revisionHistory");e.ui.registry.addButton("revisionhistory",{icon:t,tooltip:n,onAction:r}),e.ui.registry.addMenuItem("revisionhistory",{icon:t,text:n,onAction:r})})(e),(e=>{e.mode.register("revision",{activate:()=>{"revision"!==e.queryCommandValue("ToggleView")&&e.execCommand("ToggleView",!1,"revision")},deactivate:()=>{"revision"===e.queryCommandValue("ToggleView")&&e.execCommand("ToggleView",!1,"revision")},editorReadOnly:!1})})(e),lo(e,{getRevisions:r,getRevision:n})})(e,n),(e=>({diff:(t,n)=>{const r=lt(e);return ie(et(t,n,r))}}))(e);console.error("The revisionhistory plugin requires at least version 7.0 of TinyMCE.")}))}();
