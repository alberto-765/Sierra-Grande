{% extends "oscar/dashboard/layout.html" %}

{% load category_tags i18n static %}

{% block extrahead %}
  {{ block.super }}
  {{ form.media }}
{% endblock extrahead %}

{% block body_class %}
  {{ block.super }} create-page catalogue
{% endblock body_class %}

{% block title %}
  {{ title }} | {% translate "Categories" %} | {{ block.super }}
{% endblock title %}

{% block breadcrumbs %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url "dashboard:index" %}">{% translate "Dashboard" %}</a>
      </li>
      <li class="breadcrumb-item">
        <a href="{% url "dashboard:catalogue-category-list" %}">{% translate "Categories" %}</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
    </ol>
  </nav>
{% endblock breadcrumbs %}
{% block main_header_content %}
  {{ title }}
{% endblock main_header_content %}
{% block dashboard_content %}
  <form action="{% if request.GET.urlencode %}?{{ request.GET.urlencode }}{% endif %}"
        method="post"
        class="card form-steps "
        enctype="multipart/form-data"
        data-behaviour="tab-nav-errors"
        autocomplete="off">
    {% csrf_token %}
    <div class="card-header">
      <h4 class="card-title mb-0 icon-link">
        <iconify-icon icon="gridicons:create" width="1rem" height="1rem" aria-hidden="true"></iconify-icon>
        {% translate "Create the category" %}
      </h4>
    </div>
    <div class="card-body" data-behaviour="tab-nav-errors">
      <div class="step-arrow-nav mb-4">
        <ul class="nav nav-pills custom-nav nav-justified" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="category-detail" data-bs-toggle="pill" data-bs-target="#category-detail-pane" type="button" role="tab" aria-controls="category-detail-pane" aria-selected="false" data-position="0" tabindex="-1">
                {% translate "Category details" %}
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link " id="category-seo" data-bs-toggle="pill" data-bs-target="#category-seo-pane" type="button" role="tab" aria-controls="category-seo-pane" aria-selected="true" data-position="1">
                {% translate "Search engine optimisation" %}
              </button>
            </li>
        </ul>
      </div>
      <div class="tab-content">
        {% block tab_content %}
          {% block category_details %}
            <div class="tab-pane fade show active" id="category-detail-pane">
              <div class="card-text">
                {% block category_details_content %}
                  <span class="text-danger error">{{ form.non_field_errors }}</span>
                  {% for field in form.primary_form_fields %}
                    {% if forloop.last %}
                      {% include "oscar/dashboard/partials/form_field.html" with field=field form_show_errors=True %}
                    {% else %}
                      {% include "oscar/dashboard/partials/form_field.html" with field=field margin="true" form_show_errors=True %}
                    {% endif %}
                  {% endfor %}
                {% endblock category_details_content %}
              </div>
            </div>
          {% endblock category_details %}
          {% block seo %}
            <div class="tab-pane fade" id="category-seo-pane">
              <div class="card-text">
                {% block seo_content %}
                  {% for field in form.seo_form_fields %}
                    {% if forloop.last %}
                      {% include "oscar/dashboard/partials/form_field.html" with field=field form_show_errors=True %}
                    {% else %}
                      {% include "oscar/dashboard/partials/form_field.html" with field=field margin="true" form_show_errors=True %}
                    {% endif %}
                  {% endfor %}
                {% endblock seo_content %}
              </div>
            </div>
          {% endblock seo %}
        {% endblock tab_content %}
      </div>
    </div>

    {% block fixed_actions_group %}
      <div class="form-actions-fixed align-items-center bg-dark column-gap-4 fixed-bottom hstack justify-content-end p-3">
        {% if category %}
          <a class="btn btn-success me-auto" href="{{ category.get_absolute_url }}">{% translate "View on shop" %}</a>
        {% endif %}
        <a class="btn btn-danger" role="button" href="{% url "dashboard:catalogue-category-list" %}">{% translate "Cancel" %}</a>
        <button class="btn btn-outline-light"
                name="action"
                type="submit"
                value="continue"
                data-loading-text="{% translate "Saving..." %}">{% translate "Save and continue editing" %}</button>
        <button class="btn btn-primary"
                name="action"
                type="submit"
                value="save"
                data-loading-text="{% translate "Saving..." %}">{% translate "Save" %}</button>
      </div>
    {% endblock fixed_actions_group %}
  </form>
{% endblock dashboard_content %}

{% block extrascripts %}
  {{ block.super }}
  <script src="{% static "js/components/form-wizard.init.js" %}" defer></script>
  <script src="{% static "libs/choices/choices.min.js" %}" defer></script>
{% endblock extrascripts %}


{% block onbodyload %}
  {{ block.super }}
  oscar.dashboard.initProductImages();
{% endblock onbodyload %}
