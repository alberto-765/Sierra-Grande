{% extends "oscar/dashboard/layout.html" %}

{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}
  {{ title }} | {% trans "Create product type" %} | {{ block.super }}
{% endblock title %}
{% block body_class %}
  {{ block.super }} create-page
{% endblock body_class %}
{% block breadcrumbs %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url "dashboard:index" %}">{% trans "Dashboard" %}</a>
      </li>
      <li class="breadcrumb-item">
        <a href="{% url "dashboard:catalogue-class-list" %}">{% trans "Product Type" %}</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
    </ol>
  </nav>
{% endblock breadcrumbs %}
{% block headertext %}
  {{ title }}
{% endblock headertext %}
{% block dashboard_content %}
  <form class="card" method="post" data-behaviour="tab-nav-errors">
    {% csrf_token %}
    <div class="card-header">
      <ul class="nav nav-tabs card-header-tabs" id="productsTab" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="nav-link active"
             href="#product-detail"
             id="product-detail"
             data-bs-toggle="tab"
             data-bs-target="#product-detail-pane"
             role="tab"
             aria-controls="product-detail-pane"
             aria-selected="true">{% trans "Product Class details" %}</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link"
             href="#product-attributes"
             id="product-attributes"
             data-bs-toggle="tab"
             data-bs-target="#product-attributes-pane"
             role="tab"
             aria-controls="product-attributes-pane"
             aria-selected="false">{% trans "Product attributes" %}</a>
        </li>
      </ul>
    </div>
    <div class="tab-content card-body">
      <div class="tab-pane fade show active"
           id="product-detail-pane"
           role="tabpanel"
           aria-labelledby="product-detail"
           tabindex="0">
        <div class="card-text">{% crispy form %}</div>
      </div>
      <div class="tab-pane fade card-text"
           id="product-attributes-pane"
           role="tabpanel"
           aria-labelledby="product-attributes"
           tabindex="0">
        <table class="table table-bordered table-hover align-middle mb-0">
          {{ attributes_formset.management_form }}
          {{ attributes_formset.non_form_errors }}
          <thead class="table-light">
            <tr>
              <td class="w-25">{% trans "Name" %}</td>
              <td class="w-25">{% trans "Code" %}</td>
              <td>{% trans "Type" %}</td>
              <td>{% trans "Required" %}</td>
              <td>{% trans "Delete" %}</td>
            </tr>
          </thead>
          <tbody>
            {% for attribute_form in attributes_formset %}
              <tr>
                {% for hidden_field in attribute_form.hidden_fields %}{{ hidden_field }}{% endfor %}
                <td>{% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.name nolabel=True %}</td>
                <td>{% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.code nolabel=True %}</td>
                <td>
                  {% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.type nolabel=True %}
                  {% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.option_group nolabel=True %}
                </td>
                <td>
                  {% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.required nolabel=True %}
                  {{ attribute_form.non_field_errors }}
                </td>
                <td>{% include "oscar/dashboard/partials/form_field.html" with field=attribute_form.DELETE nolabel=True %}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% block fixed_actions_group %}
      <div class="align-items-center bg-dark column-gap-4 fixed-bottom hstack justify-content-end p-4">
        <a href="#"
           onclick="window.history.go(-1);return false"
           class="text-decoration-none">{% trans "Cancel" %}</a>
        <button class="btn btn-primary"
                type="submit"
                data-loading-text="{% trans "Saving..." %}">{% trans "Save" %}</button>
      </div>
    {% endblock fixed_actions_group %}
  </form>
{% endblock dashboard_content %}
{% block onbodyload %}
  {{ block.super }}
  oscar.dashboard.product_attributes.init();
  oscar.dashboard.initTooltips();
{% endblock onbodyload %}
