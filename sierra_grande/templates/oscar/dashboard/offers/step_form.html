{% extends "oscar/dashboard/layout.html" %}

{% load currency_filters i18n crispy_forms_tags static%}


{% block body_class %}
  {{ block.super }} create-page
{% endblock body_class %}

{% block title %}
  {% if offer.pk %}
    {{ offer.name }}:
  {% else %}
    {% translate "Create new offer" %}:
  {% endif %}
  {{ title }} | {% translate "Offers" %} | {{ block.super }}
{% endblock title %}

{% block breadcrumbs %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url 'dashboard:index' %}">{% translate "Dashboard" %}</a>
      </li>
      <li class="breadcrumb-item">
        <a href="{% url 'dashboard:offer-list' %}">{% translate "Offers" %}</a>
      </li>
      {% if offer.pk %}
        <li class="breadcrumb-item">
          <a href="{% url 'dashboard:offer-detail' pk=offer.pk %}">{{ offer.name }}</a>
        </li>
      {% else %}
        <li class="breadcrumb-item">{% translate "Create new offer" %}</li>
      {% endif %}
      <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
    </ol>
  </nav>
{% endblock breadcrumbs %}

{% block main_header_content %}
  {% if not offer.pk %}
    {% translate "Create new offer" %}
  {% else %}
    {{ offer.name }}
  {% endif %}
{% endblock main_header_content %}

{% block dashboard_content %}
  <div class="row vertical-navs-step">
    <div class="col-lg-3">
      {% block progress %}
        {% include "oscar/dashboard/offers/progress.html" %}
      {% endblock progress %}
    </div>
    <div class="{% if session_offer %}col-lg-6{% else %}col-lg-9{% endif %}">
      <form method="post" class="card card-body px-lg-4 ">
         <div>
            <h5>{{ title }}</h5>
            <p class="text-muted">{% translate 'Fill all fields with *' %}</p>
          </div>
        <div>
          {% block form_fields %}
            {% crispy form %}
          {% endblock form_fields %}
          {% block form_extradata %}
          {% endblock form_extradata %}
        </div>

        {% block form_actions %}
          <div class="form-actions-fixed align-items-center bg-dark column-gap-4 fixed-bottom hstack justify-content-end p-3">
            <a class="btn btn-danger" href="{% url "dashboard:offer-list" %}">{% translate "Cancel" %}</a>
            {% block form_actions_buttons %}
              {% if offer %}
                {# When editing offer, show saving button #}
                <button class="btn btn-outline-light"
                        name="save"
                        type="submit"
                        data-loading-text="{% translate "Saving..." %}">{% translate "Save changes" %}</button>
              {% endif %}
              <button class="btn btn-primary" type="submit" data-loading-text="{% translate "Submitting..." %}">
                {% block submittext %}
                  {% translate "Continue" %}
                {% endblock submittext %}
              </button>
            {% endblock form_actions_buttons %}
          </div>
        {% endblock form_actions %}

      </form>
    </div>

    {% if session_offer %}
      <div class="col-lg-3 vstack row-gap-3">
        {% block summary %}
          {% include "oscar/dashboard/offers/summary.html" %}
        {% endblock summary %}
      </div>
    {% endif %}
  </div>
{% endblock dashboard_content %}



{% block extrascripts %}
  {{ block.super }}
  <script src="{% static "libs/choices/choices.min.js" %}" defer></script>
{% endblock extrascripts %}
